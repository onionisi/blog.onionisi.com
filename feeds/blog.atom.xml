<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>TALO - Blog</title><link href="http://blog.onionisi.com/" rel="alternate"></link><link href="http://blog.onionisi.com/feeds/blog.atom.xml" rel="self"></link><id>http://blog.onionisi.com/</id><updated>2018-11-20T00:00:00+08:00</updated><entry><title>Experience of Dockerfile</title><link href="http://blog.onionisi.com/experience_of_dockerfile.html" rel="alternate"></link><published>2018-11-20T00:00:00+08:00</published><updated>2018-11-20T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2018-11-20:/experience_of_dockerfile.html</id><summary type="html">&lt;h5&gt;Experience of Dockerfile&lt;/h5&gt;
&lt;p&gt;After using docker several months, here are some tips I want to share with you&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;using &lt;code&gt;.dockerignore&lt;/code&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Its usage and syntax is similar with &lt;code&gt;.gitignore&lt;/code&gt;, so we can igore those unneeded files. It can speed up the building time and compact the image&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;only run one app …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;h5&gt;Experience of Dockerfile&lt;/h5&gt;
&lt;p&gt;After using docker several months, here are some tips I want to share with you&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;using &lt;code&gt;.dockerignore&lt;/code&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Its usage and syntax is similar with &lt;code&gt;.gitignore&lt;/code&gt;, so we can igore those unneeded files. It can speed up the building time and compact the image&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;only run one app&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;using &lt;strong&gt;Docker Compose&lt;/strong&gt; to run multi docker container instead of one. It's hard to handle logs from different apps and has a long building time and large image &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;join &lt;code&gt;RUN&lt;/code&gt; cmd as one&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;every cmd will create a new layer in image and it will be cached and reused. If cmd in Dockerfile has changed, its cache will unusable and other layers relied on it as well. So we need to combine the cmd with same changing frequency&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;deprecate &lt;code&gt;latest&lt;/code&gt; tag in based image&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;latest&lt;/code&gt; will point to a different image when updating&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;delete extra file after &lt;code&gt;RUN&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;some cmd create cache file under /var and we do not need it when building image&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;choose suitable based image(alpine)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;alpine is a distrubution for docker, its package manament tool is &lt;code&gt;apk&lt;/code&gt;, which has &lt;code&gt;no-cache&lt;/code&gt; and &lt;code&gt;--virtual&lt;/code&gt; option contributed to reducing image size.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;set &lt;code&gt;WORKDIR&lt;/code&gt; and &lt;code&gt;CMD&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;WORKDIR&lt;/code&gt; set the default dir, which is the place for &lt;code&gt;RUN/CMD/ENTRYPOINT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;CMD&lt;/code&gt; set the default running cmd when creating container.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;using &lt;code&gt;ENTRYPOINT&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It's optional, because it make things more complicated. It's just a script and default running execution.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;using &lt;code&gt;exec&lt;/code&gt; in entrypoint script&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;without &lt;code&gt;exec&lt;/code&gt; we cannot stop container because &lt;code&gt;SIGTERM&lt;/code&gt; will be ignored by bash script&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;prefer &lt;code&gt;COPY&lt;/code&gt; other than &lt;code&gt;ADD&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;ADD&lt;/code&gt; is more complicated, which can download remote file and decompress file.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;adjust the order for &lt;code&gt;COPY&lt;/code&gt; and &lt;code&gt;RUN&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;put cmd caused least change in the header of Dockerfile, which can utilise the cache.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;set default env, mapping port and volume&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;good way to run container which need some tweak or configuration&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;using &lt;code&gt;LABEL&lt;/code&gt; to set meta-data&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;such as creator or a brief desc&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;add &lt;code&gt;HEALTHCHECK&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;periodically check the health of container for monitor.&lt;/p&gt;</content><category term="docker"></category><category term="devops"></category></entry><entry><title>New Beginning</title><link href="http://blog.onionisi.com/new_beginnig.html" rel="alternate"></link><published>2018-05-01T00:00:00+08:00</published><updated>2018-05-01T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2018-05-01:/new_beginnig.html</id><summary type="html">&lt;h5&gt;New Beginning&lt;/h5&gt;
&lt;p&gt;a fresh start of another month
so I restart using todo app on iphone 
since my android phone cracked by the backdoor of my car
According to the keep record
It's already 42 days when I do keep last time
so shame&lt;/p&gt;
&lt;p&gt;yesterday new plan was made on …&lt;/p&gt;</summary><content type="html">&lt;h5&gt;New Beginning&lt;/h5&gt;
&lt;p&gt;a fresh start of another month
so I restart using todo app on iphone 
since my android phone cracked by the backdoor of my car
According to the keep record
It's already 42 days when I do keep last time
so shame&lt;/p&gt;
&lt;p&gt;yesterday new plan was made on the TickTick app
including 4 list
routine, repeated daily
career, repeated daily too
australia, you known that
urgent, remind important event&lt;/p&gt;
&lt;p&gt;AWS CSA has the highest priority
So tonight official course commence
after a series free video by linuxacademy
I choose acloud guru
I like the 'guru'&lt;/p&gt;
&lt;p&gt;I complete all the task of Today
So fabulous
when you feel too hard you are close to your goal
just stand with it for a couple of minutes
the best illustration was last night
I learned how to strike water with foot in freestyle&lt;/p&gt;
&lt;p&gt;Since I learned frogstyle, it's nearly 15month
Motivated by my dear wife who was taught by me with frogstyle, 
deciding learn freestyle by herself because of her swimming teacher without this ability,
I started to practice only using leg in freestyle.
I nearly dropped out after my body drifting through half lane of the pool,
because I can not control my body to move forward.
It was so frastrating.
Thanks for the short distance to another end, I made up my mind to finish this trip.
Like a engine, I made my leg switched up down more faster.
That was it.
Finally, my legs propel the whole body fast forward.
Getting new skill make people extremely thrill.
Next, its time for the arm part.&lt;/p&gt;
&lt;p&gt;Nothing is easy in the beginning
keep on&lt;/p&gt;</content><category term="life"></category><category term="daily"></category></entry><entry><title>Enable MFA for ssh</title><link href="http://blog.onionisi.com/mfa_for_ssh.html" rel="alternate"></link><published>2018-03-16T00:00:00+08:00</published><updated>2018-03-16T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2018-03-16:/mfa_for_ssh.html</id><summary type="html">&lt;p&gt;Usually, company realize two-factor auth for ssh through RSA SecureID. But it costs hundreds of bucks, so not a good choice for person or small company. google-authenticator comes up.&lt;/p&gt;
&lt;h5&gt;install Google Authenticator app&lt;/h5&gt;
&lt;p&gt;This app support android and iOS&lt;/p&gt;
&lt;h5&gt;compile google-authenticator on server&lt;/h5&gt;
&lt;p&gt;install level package of pam:&lt;/p&gt;
&lt;p&gt;apt: libpam0g-dev …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Usually, company realize two-factor auth for ssh through RSA SecureID. But it costs hundreds of bucks, so not a good choice for person or small company. google-authenticator comes up.&lt;/p&gt;
&lt;h5&gt;install Google Authenticator app&lt;/h5&gt;
&lt;p&gt;This app support android and iOS&lt;/p&gt;
&lt;h5&gt;compile google-authenticator on server&lt;/h5&gt;
&lt;p&gt;install level package of pam:&lt;/p&gt;
&lt;p&gt;apt: libpam0g-dev, yum: pam-devel&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone https://code.google.com/p/google-authenticator/
&lt;span class="nb"&gt;cd&lt;/span&gt; google-authenticator/libpam
make
make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;edit &lt;code&gt;/etc/pam.d/sshd&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;add following line in the beginning:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;auth required pam_google_authenticator.so
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;edit /etc/ssh/sshd_config for ChallengeResponseAuthentication&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ChallengeResponseAuthentication yes
&lt;/pre&gt;&lt;/div&gt;


&lt;h5&gt;sever setup&lt;/h5&gt;
&lt;p&gt;change to user who need google-authenticator, then run google-authenticator&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ google-authenticator 

Do you want authentication tokens to be time-based &lt;span class="o"&gt;(&lt;/span&gt;y/n&lt;span class="o"&gt;)&lt;/span&gt; y
https://www.google.com//chart?chs&lt;span class="o"&gt;=&lt;/span&gt;200x200&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nv"&gt;chld&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nv"&gt;cht&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;qr&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nv"&gt;chl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;otpauth://totp/chong@xxxxx%3Fsecret%xxxxxxxx
Your new secret key is: xxxxxx
Your verification code is xxxxx
Your emergency scratch codes are:
  xxxxxxxx

Do you want me to update your &lt;span class="s2"&gt;&amp;quot;/home/chong/.google_authenticator&amp;quot;&lt;/span&gt; file &lt;span class="o"&gt;(&lt;/span&gt;y/n&lt;span class="o"&gt;)&lt;/span&gt; y

Do you want to disallow multiple uses of the same authentication
token? This restricts you to one login about every 30s, but it increases
your chances to notice or even prevent man-in-the-middle attacks &lt;span class="o"&gt;(&lt;/span&gt;y/n&lt;span class="o"&gt;)&lt;/span&gt; y

By default, tokens are good &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="m"&gt;30&lt;/span&gt; seconds and in order to compensate &lt;span class="k"&gt;for&lt;/span&gt;
possible time-skew between the client and the server, we allow an extra
token before and after the current time. If you experience problems with poor
&lt;span class="nb"&gt;time&lt;/span&gt; synchronization, you can increase the window from its default
size of &lt;span class="m"&gt;1&lt;/span&gt;:30min to about 4min. Do you want to &lt;span class="k"&gt;do&lt;/span&gt; so &lt;span class="o"&gt;(&lt;/span&gt;y/n&lt;span class="o"&gt;)&lt;/span&gt; n

If the computer that you are logging into isn&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;t hardened against brute-force
login attempts, you can &lt;span class="nb"&gt;enable&lt;/span&gt; rate-limiting &lt;span class="k"&gt;for&lt;/span&gt; the authentication module.
By default, this limits attackers to no more than &lt;span class="m"&gt;3&lt;/span&gt; login attempts every 30s.
Do you want to &lt;span class="nb"&gt;enable&lt;/span&gt; rate-limiting &lt;span class="o"&gt;(&lt;/span&gt;y/n&lt;span class="o"&gt;)&lt;/span&gt; y
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;restart ssh service&lt;/p&gt;
&lt;h5&gt;client setup&lt;/h5&gt;
&lt;p&gt;open google-authenticator, type displayed token or open the url then scan the QRcode&lt;/p&gt;
&lt;p&gt;as you can see, the token has already changed regularly. Try to login, the way has changed.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ssh xxxx.com 
Verification code: 
Password: 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;PS: you'd better pre login two termial, one for operating, another for backup in case of the wrong conf.&lt;/p&gt;</content><category term="devops"></category><category term="ssh"></category></entry><entry><title>Vim tips</title><link href="http://blog.onionisi.com/vim_tips.html" rel="alternate"></link><published>2017-10-16T00:00:00+08:00</published><updated>2017-10-16T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2017-10-16:/vim_tips.html</id><summary type="html">&lt;h5&gt;vim ctrl-o&lt;/h5&gt;
&lt;p&gt;when you in insert mode,
&lt;code&gt;ctrl-o&lt;/code&gt; can temporarily escape insert mode without change mode&lt;/p&gt;
&lt;h5&gt;vim pattern match&lt;/h5&gt;
&lt;p&gt;Other than using Macro, you deserve pattern match, which is similar with sed.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/^&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;             &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="k"&gt;delete&lt;/span&gt; &lt;span class="n"&gt;empty&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;
&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pattern&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="k"&gt;delete&lt;/span&gt; &lt;span class="n"&gt;match&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;after&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;
&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pattern …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;h5&gt;vim ctrl-o&lt;/h5&gt;
&lt;p&gt;when you in insert mode,
&lt;code&gt;ctrl-o&lt;/code&gt; can temporarily escape insert mode without change mode&lt;/p&gt;
&lt;h5&gt;vim pattern match&lt;/h5&gt;
&lt;p&gt;Other than using Macro, you deserve pattern match, which is similar with sed.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/^&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;             &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="k"&gt;delete&lt;/span&gt; &lt;span class="n"&gt;empty&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;
&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pattern&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="k"&gt;delete&lt;/span&gt; &lt;span class="n"&gt;match&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;after&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;
&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pattern&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;nd&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="k"&gt;delete&lt;/span&gt; &lt;span class="n"&gt;match&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;before&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;
&lt;span class="nf"&gt;%s&lt;/span&gt;&lt;span class="o"&gt;/^&lt;/span&gt;&lt;span class="n"&gt;pattern&lt;/span&gt;&lt;span class="c1"&gt;//g        # delete line head in pattern       &lt;/span&gt;
&lt;span class="nf"&gt;%s&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pattern&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="c1"&gt;//g        # delete line tail in pattern       &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h5&gt;vim exmode&lt;/h5&gt;
&lt;p&gt;You can do magic things under exmode.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Q                   enter ex mode
d, m, t             delete, move, copy
/pattern/           the line match the pattern
0, ., 1, $, %       begin, current line, first line, last line, all line
- +                 line before, line after
, ;                 line ranger, readjust current line with first number
g, g!               global, global reverse
|                   cmd separator
&lt;/pre&gt;&lt;/div&gt;


&lt;h5&gt;YCM compilation database&lt;/h5&gt;
&lt;p&gt;YCM looks for a file named compile_commands.json in the directory of the opened file or in any directory above it in the hierarchy (recursively); when the file is found, it is loaded. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CMake: add -DCMAKE_EXPORT_COMPILE_COMMANDS=ON when configuring (or add set( CMAKE_EXPORT_COMPILE_COMMANDS ON ) to CMakeLists.txt) and copy or symlink the generated database to the root of your project.&lt;/li&gt;
&lt;li&gt;Ninja: check out the compdb tool (-t compdb) in its docs.&lt;/li&gt;
&lt;li&gt;GNU Make: check out Bear&lt;/li&gt;
&lt;li&gt;Others: check out .ycm_extra_conf.py below&lt;/li&gt;
&lt;/ul&gt;</content><category term="api"></category><category term="work"></category></entry><entry><title>restful api</title><link href="http://blog.onionisi.com/restful_api.html" rel="alternate"></link><published>2016-08-14T00:00:00+08:00</published><updated>2016-08-14T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2016-08-14:/restful_api.html</id><summary type="html">&lt;h4&gt;API设计理念&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="err"&gt;将涉及的实体抽象成资源&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="err"&gt;即按&lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="err"&gt;访问资源&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="err"&gt;在&lt;/span&gt;&lt;span class="nt"&gt;url&lt;/span&gt;&lt;span class="err"&gt;上做文章&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="err"&gt;以后再也不用为&lt;/span&gt;&lt;span class="nt"&gt;url&lt;/span&gt;&lt;span class="err"&gt;起名字而苦恼&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="err"&gt;使用&lt;/span&gt;&lt;span class="nt"&gt;HTTP&lt;/span&gt;&lt;span class="err"&gt;动词对资源进行&lt;/span&gt;&lt;span class="nt"&gt;CRUD&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="err"&gt;增删改查&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="nt"&gt;get-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="err"&gt;查&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;post-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="err"&gt;增&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;put-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="err"&gt;改&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;delete-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="err"&gt;删&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="nt"&gt;3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;URL&lt;/span&gt;&lt;span class="err"&gt;命名规则&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="err"&gt;对于资源无法使用一个单数名词表示的情况&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="err"&gt;使用中横线&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="err"&gt;连接&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="err"&gt;资源采用名词命名&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;g&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;产品&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;product&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="err"&gt;新增资源&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;g&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;新增产品&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;product&lt;/span&gt; &lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;verb …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;h4&gt;API设计理念&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="err"&gt;将涉及的实体抽象成资源&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="err"&gt;即按&lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="err"&gt;访问资源&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="err"&gt;在&lt;/span&gt;&lt;span class="nt"&gt;url&lt;/span&gt;&lt;span class="err"&gt;上做文章&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="err"&gt;以后再也不用为&lt;/span&gt;&lt;span class="nt"&gt;url&lt;/span&gt;&lt;span class="err"&gt;起名字而苦恼&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="err"&gt;使用&lt;/span&gt;&lt;span class="nt"&gt;HTTP&lt;/span&gt;&lt;span class="err"&gt;动词对资源进行&lt;/span&gt;&lt;span class="nt"&gt;CRUD&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="err"&gt;增删改查&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="nt"&gt;get-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="err"&gt;查&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;post-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="err"&gt;增&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;put-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="err"&gt;改&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;delete-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="err"&gt;删&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="nt"&gt;3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;URL&lt;/span&gt;&lt;span class="err"&gt;命名规则&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="err"&gt;对于资源无法使用一个单数名词表示的情况&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="err"&gt;使用中横线&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="err"&gt;连接&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="err"&gt;资源采用名词命名&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;g&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;产品&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;product&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="err"&gt;新增资源&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;g&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;新增产品&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;product&lt;/span&gt; &lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;verb&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;POST&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="err"&gt;修改资源&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;g&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;修改产品&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;products&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;id&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;verb&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;PUT&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="err"&gt;资源详情&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;g&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;指定产品详情&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;products&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;id&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;verb&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;GET&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="err"&gt;删除资源&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;g&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;删除产品&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;products&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;id&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;verb&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;DELETE&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="err"&gt;资源列表&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;g&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;产品列表&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;products&lt;/span&gt; &lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;verb&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;GET&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="err"&gt;资源关联关系&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;g&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;收藏产品&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;products&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;id&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;star&lt;/span&gt; &lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;verb&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;PUT&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="err"&gt;资源关联关系&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;g&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;删除收藏产品&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;products&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;id&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;star&lt;/span&gt; &lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;verb&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;DELETE&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="api"></category><category term="work"></category></entry><entry><title>ssh转发</title><link href="http://blog.onionisi.com/ssh_forward.html" rel="alternate"></link><published>2016-04-20T00:00:00+08:00</published><updated>2016-04-20T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2016-04-20:/ssh_forward.html</id><summary type="html">&lt;h4&gt;替代品（171220更新）&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;(ngrok)[https://ngrok.com]通过第三方服务器中转需要注册&lt;/li&gt;
&lt;li&gt;(frp)[https://github.com/fatedier/frp]新一代转发神器&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;ssh portforward&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;                   &lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;                 &lt;span class="n"&gt;S&lt;/span&gt;
&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;SSH&lt;/span&gt; &lt;span class="n"&gt;hostname&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;
&lt;span class="n"&gt;if&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ssh&lt;/span&gt; &lt;span class="n"&gt;hostname&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;SSH连接和应用的连接这两个连接的方向一致，是本地转发。 在本地这台机器上监听一个端口，然后所有访问这个端口的数据都会通过ssh 隧道传输到远端的对应端口上&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  ssh -L &amp;lt;local port&amp;gt;:&amp;lt;remote host&amp;gt;:&amp;lt;remote port&amp;gt; &amp;lt;SSH hostname&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;SSH连接和应用的连接这两个连接的方向不同，是远程转发 …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;h4&gt;替代品（171220更新）&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;(ngrok)[https://ngrok.com]通过第三方服务器中转需要注册&lt;/li&gt;
&lt;li&gt;(frp)[https://github.com/fatedier/frp]新一代转发神器&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;ssh portforward&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;                   &lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;                 &lt;span class="n"&gt;S&lt;/span&gt;
&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;SSH&lt;/span&gt; &lt;span class="n"&gt;hostname&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;
&lt;span class="n"&gt;if&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ssh&lt;/span&gt; &lt;span class="n"&gt;hostname&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;SSH连接和应用的连接这两个连接的方向一致，是本地转发。 在本地这台机器上监听一个端口，然后所有访问这个端口的数据都会通过ssh 隧道传输到远端的对应端口上&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  ssh -L &amp;lt;local port&amp;gt;:&amp;lt;remote host&amp;gt;:&amp;lt;remote port&amp;gt; &amp;lt;SSH hostname&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;SSH连接和应用的连接这两个连接的方向不同，是远程转发。 在远端服务器监听一个端口，所有访问远端服务器指定端口都会通过隧道传输到本地的对应端口上&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  ssh -R &amp;lt;local port&amp;gt;:&amp;lt;remote host&amp;gt;:&amp;lt;remote port&amp;gt; &amp;lt;SSH hostname&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;参数 CfNg
  -C ：压缩数据传输。
  -f ：后台认证用户/密码，通常和-N连用，不用登录到远程主机。
  -N ：不执行脚本或命令，通常与-f连用。
  -g ：在-L/-R/-D参数中，允许远程主机连接到建立的转发的端口，如�不加这个参数，只允许本地主机建立连接&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;ssh with tar&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;tar 注意Pp&lt;ul&gt;
&lt;li&gt;cP : contain absolute name&lt;/li&gt;
&lt;li&gt;xp : preserve permission&lt;/li&gt;
&lt;li&gt;--exclude "PATH"(without '/' at the end)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    tar czf - data | ssh user@host &amp;quot;tar xf - -C dir&amp;quot;
    ssh user@host &amp;quot;tar czf - data&amp;quot; | tar xvzf - -C dir
&lt;/pre&gt;&lt;/div&gt;</content><category term="ssh"></category><category term="work"></category></entry><entry><title>Arch on MBP</title><link href="http://blog.onionisi.com/archlinux-on-macbookpro.html" rel="alternate"></link><published>2015-07-24T00:00:00+08:00</published><updated>2015-07-30T19:30:00+08:00</updated><author><name>Chong Yang</name></author><id>tag:blog.onionisi.com,2015-07-24:/archlinux-on-macbookpro.html</id><summary type="html">&lt;p&gt;Due to my over optimization, my macbook got crashed caused by the Chromium with
too many tabs. I was so confidence to disable the journal function of hfs+,
obviously it was a big mistake. I could't recovery my OSX, so after bearing a 
long time with hfs+, I choose to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Due to my over optimization, my macbook got crashed caused by the Chromium with
too many tabs. I was so confidence to disable the journal function of hfs+,
obviously it was a big mistake. I could't recovery my OSX, so after bearing a 
long time with hfs+, I choose to back home, the archlinux.&lt;/p&gt;
&lt;p&gt;Thanks god, most hardware components already have got a nice compatible.
Especially the Ratina display, Cinnamon desktop have a auto option in DPI.As a
result, you can have a different dpi on diffrerent monitor. That is pretty nice
for me because I always works with my BENQ BL2410, a 24' monitor I bought a few
years ago.&lt;/p&gt;
&lt;p&gt;Only wifi driver is in AUR. And I also make a script to control the fan,
just a single fan in MBP 13' late 2013. It's for the flash, damn flash. &lt;/p&gt;
&lt;h3&gt;Install&lt;/h3&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;gdisk, reserved for sdx1 for EFI.&lt;/li&gt;
&lt;li&gt;efibootmgr, watch the BootOrder&lt;/li&gt;
&lt;li&gt;Loader, grub or rEFInd &lt;/li&gt;
&lt;li&gt;broadcom-wl, WIFI driver by broadcom in AUR&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;After Install&lt;/h3&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;xinitrc&lt;/li&gt;
&lt;li&gt;IM, ibus doesn't work well with cinnmon-panel, fcitx-rime(insteaded by yong)&lt;/li&gt;
&lt;li&gt;backlight, xbacklight(no need coz cinnamon)&lt;/li&gt;
&lt;li&gt;fan, script&lt;/li&gt;
&lt;li&gt;font, fira-mono, simsum(Mono font I will write another post)&lt;/li&gt;
&lt;li&gt;powersave, modprobe file&lt;/li&gt;
&lt;li&gt;network, netctl can not connect a hidden WIFI(back to network-manager)&lt;/li&gt;
&lt;li&gt;openbox, obconf(not use now)&lt;/li&gt;
&lt;li&gt;cinnamon&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hope you guys all enjoy linux!&lt;/p&gt;</content><category term="archlinux"></category><category term="config"></category></entry><entry><title>vim二三事</title><link href="http://blog.onionisi.com/vim_plugin_I_used.html" rel="alternate"></link><published>2015-03-19T00:00:00+08:00</published><updated>2015-03-19T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2015-03-19:/vim_plugin_I_used.html</id><summary type="html">&lt;p&gt;话说天下编辑器分为两派，不知不觉从了vim老久了，老夫老妻就感觉没激情了，不想捯饬各种配置，这不趁着neo-vim的新鲜劲儿，重新梳理了一遍配置。&lt;/p&gt;
&lt;h3&gt;nvim&lt;/h3&gt;
&lt;p&gt;这个vim的岁数也不小了，几十年来，江湖众人想搞个小鲜肉大家尝尝，neo-vim便是其中之一。这货骨骼精奇，尽得前辈真传，同时还自创不少武术套路，确实是值得会会。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;alias vi=&amp;#39;nvim&amp;#39;
cp ~/.vimrc ~/.nvimrc
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;配置完全兼容，这丝滑。命令响应采用S/C模式，so后台会有一个单独pymodule neovim监听。得益于新的软件架构，插件执行效率更高更快。新特性还有vt，可直接集成终端，各位可自行前往github围观。&lt;/p&gt;
&lt;h3&gt;vundle&lt;/h3&gt;
&lt;p&gt;自由软件的世界不能没有包管理，你看看各大发行板，你看看node，你看看ruby/python，你看看go，现在新的编程语言没有这个好意思发布么，再看看rust。那么vim这个屌丝呢，也有很多包管理哦，vundle和github结合较好，比较好用的说。&lt;/p&gt;
&lt;p&gt;呃，vundle的interface早就更改了，Bundle变Plugin了，妈蛋，老子还一直纳闷怎么插件都不更新了 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;话说天下编辑器分为两派，不知不觉从了vim老久了，老夫老妻就感觉没激情了，不想捯饬各种配置，这不趁着neo-vim的新鲜劲儿，重新梳理了一遍配置。&lt;/p&gt;
&lt;h3&gt;nvim&lt;/h3&gt;
&lt;p&gt;这个vim的岁数也不小了，几十年来，江湖众人想搞个小鲜肉大家尝尝，neo-vim便是其中之一。这货骨骼精奇，尽得前辈真传，同时还自创不少武术套路，确实是值得会会。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;alias vi=&amp;#39;nvim&amp;#39;
cp ~/.vimrc ~/.nvimrc
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;配置完全兼容，这丝滑。命令响应采用S/C模式，so后台会有一个单独pymodule neovim监听。得益于新的软件架构，插件执行效率更高更快。新特性还有vt，可直接集成终端，各位可自行前往github围观。&lt;/p&gt;
&lt;h3&gt;vundle&lt;/h3&gt;
&lt;p&gt;自由软件的世界不能没有包管理，你看看各大发行板，你看看node，你看看ruby/python，你看看go，现在新的编程语言没有这个好意思发布么，再看看rust。那么vim这个屌丝呢，也有很多包管理哦，vundle和github结合较好，比较好用的说。&lt;/p&gt;
&lt;p&gt;呃，vundle的interface早就更改了，Bundle变Plugin了，妈蛋，老子还一直纳闷怎么插件都不更新了，怪不得老是同步不上捏。是时候好好整理一下vim的插件啦，不然还说是vimer，囧rz。&lt;/p&gt;
&lt;p&gt;配置文件也有变化，晕&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;call vundle#rc()
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;现在变成&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;call vundle#begin()
...
call vundle#end()
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;常用Plugin&lt;/h3&gt;
&lt;p&gt;积累了不少插件和快捷键，和大家share一下&lt;/p&gt;
&lt;h4&gt;常规四件&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Plugin &amp;#39;scrooloose/nerdtree&amp;#39;
Plugin &amp;#39;bling/vim-airline&amp;#39;
Plugin &amp;#39;majutsushi/tagbar&amp;#39;
Plugin &amp;#39;minibufexpl.vim&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;东南西北四大神兽打先锋，nerdtree作文件导航，airline替代powerline美化bar，tagbar替补taglist分析文本展现词条，minibufexpl管理buffer&lt;/p&gt;
&lt;h4&gt;编辑能手&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Plugin &amp;#39;tpope/vim-commentary&amp;#39;
Plugin &amp;#39;kien/ctrlp.vim&amp;#39;
Plugin &amp;#39;Valloric/YouCompleteMe&amp;#39;
Plugin &amp;#39;ervandew/supertab&amp;#39;
Plugin &amp;#39;mattn/emmet-vim&amp;#39;
Plugin &amp;#39;godlygeek/tabular&amp;#39;
Plugin &amp;#39;rking/ag.vim&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;commentary自动帮你识别注释符号，你只需要选中并注释，无需亲自编辑。  &lt;br&gt;
ctrlp不必多说，文件查找神奇，同时注意ignore各种无关文件  &lt;br&gt;
YCM更不必废话，但是更新后要重新编译，感叹为什么我写C的时候没出来？？一般与supertab配合使用。  &lt;br&gt;
emmet，敲代码最烦的就是符号配对啦，你要编辑html怎么能少了她！  &lt;br&gt;
tabular对齐神器，为了代码更有逼格，你值得试试  &lt;br&gt;
ag全称advanced grep，完爆grep，you known，宇宙最强文本搜索，该插件直接调用的shell&lt;/p&gt;
&lt;h4&gt;类型识别&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Plugin &amp;#39;klen/python-mode&amp;#39;
Plugin &amp;#39;fatih/vim-go&amp;#39;
Plugin &amp;#39;plasticboy/vim-markdown&amp;#39;
Plugin &amp;#39;elzr/vim-json&amp;#39;
Plugin &amp;#39;scrooloose/syntastic‘
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;靠python养家的我怎能没有你，python-mode  &lt;br&gt;
go有自己的官方插件，但是这个打包的更好，话说go真心不错，像极了python和C的bastard  &lt;br&gt;
不写md的同学难道你写rst &lt;br&gt;
json貌似在浏览器里看得多点  &lt;br&gt;
syntastic语法检测，避免出错    &lt;/p&gt;
&lt;h3&gt;基本配置&lt;/h3&gt;
&lt;p&gt;还有一些可配置小点，各位小主有兴趣可以取用。&lt;/p&gt;
&lt;p&gt;集中各中间文件，方便统一处理。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot; Centralize backups, swapfiles and undo history
set backupdir=~/.vim/backups
set directory=~/.vim/swaps
if exists(&amp;quot;&amp;amp;amp;undodir&amp;quot;)
    set undodir=~/.vim/undo
    set undofile
    set undolevels=500
    set undoreload=500
endif
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;不同类型文档不同缩进&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;au FileType javascript,sass setlocal ts=2 sw=2 sts=2 et
au FileType python setlocal ts=4 sw=4 sts=4 et
&lt;/pre&gt;&lt;/div&gt;</content><category term="vim"></category><category term="plugin"></category></entry><entry><title>tmux的粘贴复制</title><link href="http://blog.onionisi.com/CP_of_tmux.html" rel="alternate"></link><published>2014-10-15T00:00:00+08:00</published><updated>2014-10-15T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2014-10-15:/CP_of_tmux.html</id><summary type="html">&lt;p&gt;电脑打开用的就是终端和浏览器，终端又是tmux掌控，所以不管tmux下cmd各程序或与桌面程序互通有无的时候，把tmux伺候好就OK啦。&lt;/p&gt;
&lt;h3&gt;复制模式&lt;/h3&gt;
&lt;p&gt;业务部门，又有新特性要开发啦。咦，这个功能点实现似曾相识，找找代码片段啊，打印机模式开启。JJYY一句，肯定有人说vim能粘贴复制要你干嘛，拜托同学们看看，clipboard特性打开没有。没有的同学用tmux先顶着，空了再去倒腾自定义编译。还有屏中某个小窗口程序的输出很有用，需编辑或记录，鼠标一拖，整屏都下来了，愁人。&lt;/p&gt;
&lt;p&gt;tmux下凡走过必留痕，copy模式下一览无疑。下边的配置，几个命令都被我作了映射，可以改成自己熟悉的键位。不论一屏分几个窗口，都不会串行啦。one more thing, 我经常用copy-mode当历史模式使用，翻屏棒棒哒。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# copy mode
setw -g mode-keys vi              # keymap in copy mode
bind Escape copy-mode             # enter copy mode …&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;电脑打开用的就是终端和浏览器，终端又是tmux掌控，所以不管tmux下cmd各程序或与桌面程序互通有无的时候，把tmux伺候好就OK啦。&lt;/p&gt;
&lt;h3&gt;复制模式&lt;/h3&gt;
&lt;p&gt;业务部门，又有新特性要开发啦。咦，这个功能点实现似曾相识，找找代码片段啊，打印机模式开启。JJYY一句，肯定有人说vim能粘贴复制要你干嘛，拜托同学们看看，clipboard特性打开没有。没有的同学用tmux先顶着，空了再去倒腾自定义编译。还有屏中某个小窗口程序的输出很有用，需编辑或记录，鼠标一拖，整屏都下来了，愁人。&lt;/p&gt;
&lt;p&gt;tmux下凡走过必留痕，copy模式下一览无疑。下边的配置，几个命令都被我作了映射，可以改成自己熟悉的键位。不论一屏分几个窗口，都不会串行啦。one more thing, 我经常用copy-mode当历史模式使用，翻屏棒棒哒。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# copy mode
setw -g mode-keys vi              # keymap in copy mode
bind Escape copy-mode             # enter copy mode (prefix Escape)
bind ^p pasteb                    # paste buffer (prefix p)
bind -t vi-copy v begin-selection # select (v)
bind -t vi-copy y copy-selection  # copy (y)
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;粘贴到系统&lt;/h3&gt;
&lt;p&gt;哎哟，程序报异常啦，赶紧复制log或者exception到股沟看看爆栈有没有相关信息。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# copy tmux buffer to system
if-shell &amp;#39;test &amp;quot;$(uname -s)&amp;quot; = &amp;quot;Darwin&amp;quot;&amp;#39; &amp;#39;bind-key y run-shell &amp;quot;tmux show-buffer | pbcopy&amp;quot; \; display-message &amp;quot;Copied tmux buffer to system clipboard&amp;quot;&amp;#39;
if-shell &amp;#39;test &amp;quot;$(uname -s)&amp;quot; = &amp;quot;Linux&amp;quot;&amp;#39; &amp;#39;bind-key y run-shell &amp;quot;tmux show-buffer | xclip -sel clip -i&amp;quot; \; display-message &amp;quot;Copied tmux buffer to system clipboard&amp;quot;&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;不只是分屏&lt;/h3&gt;
&lt;p&gt;你们呐，naive，以为tmux就代替screen什么的分分屏那么简单？&lt;/p&gt;
&lt;p&gt;&lt;code&gt;status-left/right&lt;/code&gt;可以玩玩咯，配合自己的脚本或者命令，让你想看到跃至眼底。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;command-prompt&lt;/code&gt;更可以玩玩，交叉互动，观看男人页各种手册文档之良品。&lt;/p&gt;</content><category term="tmux"></category><category term="conf"></category></entry><entry><title>FTDI串口驱动</title><link href="http://blog.onionisi.com/serial_driver.html" rel="alternate"></link><published>2014-08-28T00:00:00+08:00</published><updated>2014-08-28T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2014-08-28:/serial_driver.html</id><summary type="html">&lt;p&gt;用MAC的同学应该搞应用和设计的居多，什么嵌入式啊，串口啊，定时器的很多同学应该都不感冒的。偶尔自己也玩玩一些硬件，所以串口这个东西还是少不了的。说起驱动，Linux对硬件的支持自不必多说，OS X就得自己动手了。&lt;/p&gt;
&lt;h3&gt;FTDI2232&lt;/h3&gt;
&lt;p&gt;普通的USB转232的芯片不支持热拔插，原来的办公室已经躺尸了很多了，手中的2232其实是上大学的参加ZLG的竞赛发的一块开发版，旁边带的JTAG的调试，我顺手就用来当串口了，很是好使。最近想玩玩好久没碰的毕业论文的小车车了，想当年的巡线和遥控，哈哈，还是很佩服我自己的。&lt;/p&gt;
&lt;p&gt;话不多说先上官网下驱动和doc，真的是不看官方的&lt;a href="http://www.ftdichip.com/Support/Documents/AppNotes/AN_134_FTDI_Drivers_Installation_Guide_for_MAC_OSX.pdf"&gt;Install Guide&lt;/a&gt;，你还真弄不对。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;The VCP driver is provided as part of the kernel in OSX 10.9, therefore no driver installation is required to create a virtual …&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;用MAC的同学应该搞应用和设计的居多，什么嵌入式啊，串口啊，定时器的很多同学应该都不感冒的。偶尔自己也玩玩一些硬件，所以串口这个东西还是少不了的。说起驱动，Linux对硬件的支持自不必多说，OS X就得自己动手了。&lt;/p&gt;
&lt;h3&gt;FTDI2232&lt;/h3&gt;
&lt;p&gt;普通的USB转232的芯片不支持热拔插，原来的办公室已经躺尸了很多了，手中的2232其实是上大学的参加ZLG的竞赛发的一块开发版，旁边带的JTAG的调试，我顺手就用来当串口了，很是好使。最近想玩玩好久没碰的毕业论文的小车车了，想当年的巡线和遥控，哈哈，还是很佩服我自己的。&lt;/p&gt;
&lt;p&gt;话不多说先上官网下驱动和doc，真的是不看官方的&lt;a href="http://www.ftdichip.com/Support/Documents/AppNotes/AN_134_FTDI_Drivers_Installation_Guide_for_MAC_OSX.pdf"&gt;Install Guide&lt;/a&gt;，你还真弄不对。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;The VCP driver is provided as part of the kernel in OSX 10.9, therefore no driver installation is required to create a virtual COM port in Mavericks. 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;因为是Yosemite，自己又重新去&lt;code&gt;/System/Library/Extensions/IOUSBFamily.kext/Contents/Plugins&lt;/code&gt;确认了一下&lt;code&gt;AppleUSBFTDI.kext&lt;/code&gt;的存在。插上USB接口，查看&lt;code&gt;/dev/tty.usbserial-xxxxxxxx&lt;/code&gt;是否出现，但是结果是令人失望的。&lt;/p&gt;
&lt;p&gt;Troubleshooting里还是解答了我的疑惑&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;If the device does not work after installing the driver, it is likely to be because the PID is not supported by the driver. 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;因为没有lsusb，只能去系统信息里去确认了一下VID为0x0403，PID为0xbcd8，与原厂0x6001不同，需要调整。&lt;/p&gt;
&lt;h3&gt;&lt;a href="http://www.ftdichip.com/Support/Documents/TechnicalNotes/TN_105%20Adding%20Support%20for%20New%20FTDI%20Devices%20to%20Mac%20Driver.pdf"&gt;Solution&lt;/a&gt;:&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;The Info.plist file contains entries for various FTDI devices in the IOKitPersonalities dictionary. A new entry for an OEM device can be created by copying the personality of the equivalent FTDI device. In the simplest case, only the new device&amp;#39;s name and idProduct key have to be provided. FTDI recommends that new OEM device personalities are added to the plist file, and existing FTDI personalities are retained. 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;重新添加来一条2232D的描述，注意VID与PID即可。&lt;/p&gt;
&lt;h3&gt;串口软件&lt;/h3&gt;
&lt;p&gt;这个主要看大家口味了，putty，screen大家用的比较多，反正我是minicom的忠实用户了。主要就是波特率的设置了，乱码了什么的除了线接错了，就是波特率不对了，have fun，buddy！&lt;/p&gt;</content><category term="OSX"></category><category term="driver"></category></entry><entry><title>OSX ipv6</title><link href="http://blog.onionisi.com/osx-ipv6.html" rel="alternate"></link><published>2014-08-14T00:00:00+08:00</published><updated>2014-08-14T00:00:00+08:00</updated><author><name>Chong Yang</name></author><id>tag:blog.onionisi.com,2014-08-14:/osx-ipv6.html</id><summary type="html">&lt;p&gt;今天心血来潮想弄把IPv6，因为这PAC让部分网站抽风。不用说只能通过tunnel实现，我大西南地区向来就是敢为人后的代表。之前在Archlinux上配过aiccu和gogoc都挺好，两个都要自行去申请账号哦。其中gogoc需要时间同步，误差太大就连不上啦，之前折腾了半天，注意同步网络时间。&lt;/p&gt;
&lt;p&gt;brew里没找见gogoc，直接就上aiccu了，得知需要tuntap依赖，其实就是内核扩展，这里就有个坑（主要是用Yosemite的同学）了，各位注意：&lt;strong&gt;tuntap的ext没法加载&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt;，console日志报错没有签名，10.10的不允许使用未签名kexts&lt;sup id="fnref:2"&gt;&lt;a class="footnote-ref" href="#fn:2" rel="footnote"&gt;2&lt;/a&gt;&lt;/sup&gt;。&lt;/strong&gt;解决方式如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;disable kext signing checks for everything, by doing &lt;code&gt;sudo nvram boot-args="kext-dev-mode=1"&lt;/code&gt;and rebooting.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;signed tun/tap.ext in the bundle of tunnelblick, just …&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;</summary><content type="html">&lt;p&gt;今天心血来潮想弄把IPv6，因为这PAC让部分网站抽风。不用说只能通过tunnel实现，我大西南地区向来就是敢为人后的代表。之前在Archlinux上配过aiccu和gogoc都挺好，两个都要自行去申请账号哦。其中gogoc需要时间同步，误差太大就连不上啦，之前折腾了半天，注意同步网络时间。&lt;/p&gt;
&lt;p&gt;brew里没找见gogoc，直接就上aiccu了，得知需要tuntap依赖，其实就是内核扩展，这里就有个坑（主要是用Yosemite的同学）了，各位注意：&lt;strong&gt;tuntap的ext没法加载&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt;，console日志报错没有签名，10.10的不允许使用未签名kexts&lt;sup id="fnref:2"&gt;&lt;a class="footnote-ref" href="#fn:2" rel="footnote"&gt;2&lt;/a&gt;&lt;/sup&gt;。&lt;/strong&gt;解决方式如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;disable kext signing checks for everything, by doing &lt;code&gt;sudo nvram boot-args="kext-dev-mode=1"&lt;/code&gt;and rebooting.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;signed tun/tap.ext in the bundle of tunnelblick, just copy it to /Library/Extensions.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;1st我认为还是会有风险将影响整个系统内核的加载，虽然有盆友成功了。2nd还是安全无痛滴，先行安装tunnelblick，然后cp，一load就出现了/dev/tun0等装置。&lt;/p&gt;
&lt;p&gt;毕竟是同根生，配置文件都没动，直接从dropbox down下来，&lt;code&gt;sudo aiccu start /path/config&lt;/code&gt;，当当当当。。。我的ipv6地址：2401:e800:100:bb::2&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;&lt;a href="https://github.com/Homebrew/homebrew/issues/31153"&gt;tuntap does not work on Yosemite 10.10&lt;/a&gt;&amp;#160;&lt;a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;&lt;a href="https://github.com/Homebrew/homebrew/issues/31164"&gt;Unsigned kexts cannot be used on 10.10&lt;/a&gt;&amp;#160;&lt;a class="footnote-backref" href="#fnref:2" rev="footnote" title="Jump back to footnote 2 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content><category term="OSX"></category><category term="network"></category><category term="ipv6"></category></entry><entry><title>OSX Launchd</title><link href="http://blog.onionisi.com/osx-launchd.html" rel="alternate"></link><published>2014-07-21T00:00:00+08:00</published><updated>2014-07-21T00:00:00+08:00</updated><author><name>Chong Yang</name></author><id>tag:blog.onionisi.com,2014-07-21:/osx-launchd.html</id><summary type="html">&lt;p&gt;习惯了Linux下init，rc或者systemd的方式，来到Mac下想搞个启动项还是要费费脑子重新学习下除了鼠标点击的账户-&amp;gt;登录项以及dock上的登陆时打开，毕竟总多的系统级别的程序是在launchd的统治下。&lt;/p&gt;
&lt;h3&gt;文件&lt;/h3&gt;
&lt;p&gt;cmd总是跟文件脱不了干系的，plist开始登场，下边是他存在的世界，摘自launchctl男人页：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    ~/Library/LaunchAgents         Per-user agents provided by the user.
    /Library/LaunchAgents          Per-user agents provided by the administrator.
    /Library/LaunchDaemons         System wide daemons provided by the administrator.
    /System/Library/LaunchAgents   OS X Per-user agents.
    /System/Library/LaunchDaemons  OS X System wide daemons …&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;习惯了Linux下init，rc或者systemd的方式，来到Mac下想搞个启动项还是要费费脑子重新学习下除了鼠标点击的账户-&amp;gt;登录项以及dock上的登陆时打开，毕竟总多的系统级别的程序是在launchd的统治下。&lt;/p&gt;
&lt;h3&gt;文件&lt;/h3&gt;
&lt;p&gt;cmd总是跟文件脱不了干系的，plist开始登场，下边是他存在的世界，摘自launchctl男人页：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    ~/Library/LaunchAgents         Per-user agents provided by the user.
    /Library/LaunchAgents          Per-user agents provided by the administrator.
    /Library/LaunchDaemons         System wide daemons provided by the administrator.
    /System/Library/LaunchAgents   OS X Per-user agents.
    /System/Library/LaunchDaemons  OS X System wide daemons.
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;In the launchd lexicon, a “daemon” is, by definition, a system-wide service of which there is one instance for all clients. An “agent” is a service that runs on a per-user basis. Daemons should not attempt to display UI or interact directly with a user’s login session. Any and all work that involves interacting with a user should be done through agents.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;其中LaunchAgents与LaunchDaemons的区别就是启动顺序是在用户登录前还是后的差别。&lt;/p&gt;
&lt;p&gt;另外plist的格式各位亲也请查阅launchd.plist相关男人页，话说我最讨厌的就是xml，html这类的标记语言了，为什么还要用来配置系统Mac兄？！&lt;/p&gt;
&lt;h5&gt;Required and recommended property list keys&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h5&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="left"&gt;Key&lt;/th&gt;
&lt;th align="left"&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="left"&gt;Label&lt;/td&gt;
&lt;td align="left"&gt;Contains a unique string that identifies your daemon to launchd. (required)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="left"&gt;ProgramArguments&lt;/td&gt;
&lt;td align="left"&gt;Contains the arguments used to launch your daemon. (required)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="left"&gt;inetdCompatibility&lt;/td&gt;
&lt;td align="left"&gt;Indicates that your daemon requires a separate instance per incoming connection. This causes launchd to behave like inetd, passing each daemon a single socket that is already connected to the incoming client. (required if your daemon was designed to be launched by inetd; otherwise, must not be included)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="left"&gt;KeepAlive&lt;/td&gt;
&lt;td align="left"&gt;This key specifies whether your daemon launches on-demand or must always be running. It is recommended that you design your daemon to be launched on-demand.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3&gt;操刀&lt;/h3&gt;
&lt;p&gt;其实主要操作就是launchctl load与unload，但是有两种情况需要区分&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;标记/var/db/launchd.db/com.apple.launchd/overrides.plist，如果没有再查看plist Label是否Disable。&lt;/li&gt;
&lt;li&gt;mv plist文件使其不出现在上述5个目录。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;想要禁用某程序自启动，先找到该文件路径，照上述方式即可搞定。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;grep -rl name_of_program /Library/Launch* /System/Library/Launch* | xargs wc -l | sort -n | head -n1 | awk &amp;#39;{print $2}&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;多技能get&lt;sup id="fnref:2"&gt;&lt;a class="footnote-ref" href="#fn:2" rel="footnote"&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;cron，关键属性&lt;code&gt;StartInterval&lt;/code&gt;，每多少秒执行一次，
&lt;code&gt;StartCalendarInterval&lt;/code&gt;简直就是cron的复刻版，但提供了更多的控制选项，不用单独再整理crontab了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;file watcher，&lt;code&gt;WatchPaths&lt;/code&gt;有任何改动即启动，&lt;code&gt;QueueDirectories&lt;/code&gt;任务开始文件夹必须为空，监控新文件并处理，网络编程select即视感。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PS: 图形前端&lt;a href="http://sites.fastspring.com/peterborgapps/product/lingonx"&gt;Lingon X&lt;/a&gt;可用但要10刀，App Store版本因为提权原因功能不完整。&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;&lt;a href="https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html"&gt;苹果开发者中心文档&lt;/a&gt;&amp;#160;&lt;a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;&lt;a href="http://paul.annesley.cc/2012/09/mac-os-x-launchd-is-cool/"&gt;launchd is cool&lt;/a&gt;&amp;#160;&lt;a class="footnote-backref" href="#fnref:2" rev="footnote" title="Jump back to footnote 2 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content><category term="OSX"></category><category term="init"></category></entry><entry><title>Mac vim taglist failed</title><link href="http://blog.onionisi.com/taglist_failed.html" rel="alternate"></link><published>2014-05-13T00:00:00+08:00</published><updated>2014-05-13T00:00:00+08:00</updated><author><name>Chong Yang</name></author><id>tag:blog.onionisi.com,2014-05-13:/taglist_failed.html</id><summary type="html">&lt;p&gt;vim的常规插件taglist报错了，妈蛋，没有你我怎么看C code&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Taglist&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Failed&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;generate&lt;/span&gt; &lt;span class="n"&gt;tags&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="sr"&gt;/Users/chong/code/redis-3.0-annotated/src/&lt;/span&gt;&lt;span class="n"&gt;ae&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;c&lt;/span&gt;
&lt;span class="sr"&gt;/Library/Developer/CommandLineTools/usr/bin/&lt;/span&gt;&lt;span class="n"&gt;ctags&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;illegal&lt;/span&gt; &lt;span class="n"&gt;option&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt; &lt;span class="o"&gt;-^&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;usage&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ctags&lt;/span&gt; &lt;span class="o"&gt;[-&lt;/span&gt;&lt;span class="n"&gt;BFadtuwvx&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="n"&gt;tagsfile&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="o"&gt;...^&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;出了问题习惯性先看源码，跑到taglist.vim里边找了一圈，4k多行，没有线索，只能发大招Google-fu了，顺带吐槽gfw。&lt;/p&gt;
&lt;p&gt;taglist faq原文如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Q&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;Are&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;using&lt;/span&gt; &lt;span class="n"&gt;exuberant&lt;/span&gt; &lt;span class="n"&gt;ctags&lt;/span&gt; &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="mf"&gt;5.0 …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;vim的常规插件taglist报错了，妈蛋，没有你我怎么看C code&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Taglist&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Failed&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;generate&lt;/span&gt; &lt;span class="n"&gt;tags&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="sr"&gt;/Users/chong/code/redis-3.0-annotated/src/&lt;/span&gt;&lt;span class="n"&gt;ae&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;c&lt;/span&gt;
&lt;span class="sr"&gt;/Library/Developer/CommandLineTools/usr/bin/&lt;/span&gt;&lt;span class="n"&gt;ctags&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;illegal&lt;/span&gt; &lt;span class="n"&gt;option&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt; &lt;span class="o"&gt;-^&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;usage&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ctags&lt;/span&gt; &lt;span class="o"&gt;[-&lt;/span&gt;&lt;span class="n"&gt;BFadtuwvx&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="n"&gt;tagsfile&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="o"&gt;...^&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;出了问题习惯性先看源码，跑到taglist.vim里边找了一圈，4k多行，没有线索，只能发大招Google-fu了，顺带吐槽gfw。&lt;/p&gt;
&lt;p&gt;taglist faq原文如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Q&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;Are&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;using&lt;/span&gt; &lt;span class="n"&gt;exuberant&lt;/span&gt; &lt;span class="n"&gt;ctags&lt;/span&gt; &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;above&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;
&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;The&lt;/span&gt; &lt;span class="n"&gt;taglist&lt;/span&gt; &lt;span class="n"&gt;plugin&lt;/span&gt; &lt;span class="n"&gt;relies&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;features&lt;/span&gt; &lt;span class="n"&gt;supported&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;exuberant&lt;/span&gt; &lt;span class="n"&gt;ctags&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;not&lt;/span&gt; &lt;span class="n"&gt;work&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;GNU&lt;/span&gt; &lt;span class="n"&gt;ctags&lt;/span&gt; &lt;span class="n"&gt;or&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;Unix&lt;/span&gt; &lt;span class="n"&gt;ctags&lt;/span&gt; &lt;span class="n"&gt;utility&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;遂只能brew重新安装ctags，link ctags到/usr/local/bin/，该路径恰好在PATH变量中在/usr/bin前边，无缝替代ctags。若不想破坏emacs ctags，可在vimrc中另行此法：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;let Tlist_Ctags_Cmd = &amp;#39;/path/to/ctags&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;作为屌丝程序员为了跨平台，怎能就此作罢，不来两句if else怎么能行，参观学习&lt;a href="http://stackoverflow.com/questions/2842078/how-do-i-detect-os-x-in-my-vimrc-file-so-certain-configurations-will-only-appl"&gt;detect osx in vimrc&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;if has(&amp;quot;unix&amp;quot;)
  let s:uname = system(&amp;quot;uname&amp;quot;)
  if s:uname == &amp;quot;Darwin\n&amp;quot;
    let Tlist_Ctags_Cmd = &amp;#39;/path/to/ctags&amp;#39;
  endif
endif
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;has是指vim特性，可通过feature-list查看，手贱的同学可能去看了，我堂堂大vim怎么会没有多系统检测，其中明明有mac的嘛，可就是不行啊，还有macvim啊，也不行，虾米原因？
&lt;strong&gt;系统自带的vim只有unix特性，mac/macunix则没有&lt;/strong&gt;，只有MacVim可用这两种特性（槽点：cmd这么不受待见啊）。参考&lt;a href="http://stackoverflow.com/questions/6146633/vimscript-how-do-i-get-the-os-that-is-running-vim?rq=1"&gt;get os in vim&lt;/a&gt;&lt;/p&gt;</content><category term="OSX"></category><category term="vim"></category><category term="plugin"></category></entry><entry><title>After New Install</title><link href="http://blog.onionisi.com/after-new-install.html" rel="alternate"></link><published>2014-05-10T00:00:00+08:00</published><updated>2014-08-15T19:30:00+08:00</updated><author><name>Chong Yang</name></author><id>tag:blog.onionisi.com,2014-05-10:/after-new-install.html</id><summary type="html">&lt;p&gt;升级到10.10的Yosemite第一个感觉是好多app要遭殃了，首先是alfred(虽然重点是workflow，但我很少用)，然后是各种输入法和一票终端。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;给Terminal选个好看的配色，这货也可以切割面板了，不过我还是喜欢iterm2的全局键呼出。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;change host name，没有好听得名字怎么能行:&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo scutil --set HostName Yosemite
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Command Line Tools for Xcode 6找得我好辛苦，没有cmd我怎么活。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;迅速安装brew and brew cask，没有包管理器我怎么活。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;迅速安装一票app，tmux vim zsh firefox mou flux&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;各种配置tmux，再也不用担心如何切分窗口，vim再也不要彷徨什么神编辑啦，zsh＝＝oh-my-zsh&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;cross the gfw.安装goagentx。 pac and goagent and …&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;升级到10.10的Yosemite第一个感觉是好多app要遭殃了，首先是alfred(虽然重点是workflow，但我很少用)，然后是各种输入法和一票终端。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;给Terminal选个好看的配色，这货也可以切割面板了，不过我还是喜欢iterm2的全局键呼出。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;change host name，没有好听得名字怎么能行:&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo scutil --set HostName Yosemite
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Command Line Tools for Xcode 6找得我好辛苦，没有cmd我怎么活。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;迅速安装brew and brew cask，没有包管理器我怎么活。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;迅速安装一票app，tmux vim zsh firefox mou flux&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;各种配置tmux，再也不用担心如何切分窗口，vim再也不要彷徨什么神编辑啦，zsh＝＝oh-my-zsh&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;cross the gfw.安装goagentx。 pac and goagent and shadowsocks&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;goagent&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;onionisi1986&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;onionisi1987&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;onionisi1988&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;onionisi1989&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;yangchong198628&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;shadowsocks&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="mf"&gt;198.199&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;96.65&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8388&lt;/span&gt; &lt;span class="n"&gt;judy&lt;/span&gt; &lt;span class="n"&gt;aes&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cfb&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;换个更顺手输入法，系统自带不错，不用啦。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;disable dashboard。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;defaults write com.apple.dashboard mcx-disabled -boolean YES &amp;amp;&amp;amp; killall Dock
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;way to displace loadavg procfile.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sysctl -n vm.loadavg
w | head -n1 | cut -d’:’ -f4
uptime | cut -d’:’ -f4
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;noatime for the SSD&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;add quit to the finder menu&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;defaults write com.apple.Finder QuitMenuItem 1
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;更快的国内源&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;npm
$npm --registry http://registry.npm.taobao.org info underscore
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;gem
$gem sources --remove https://rubygems.org/
$gem sources -a https://ruby.taobao.org
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip
Global settings:
Add ~/.pip/pip.conf that includes:
[global]
index-url = http://pypi.tuna.tsinghua.edu.cn/simple
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;“China Internet Network Information Center EV Certificates Root”，和“CNNIC ROOT”
untrust！！！&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;openerDNS: 42.120.21.30，树大招风已死，还是用台湾同胞的61.139.2.69，以及阿里的223.5.5.5与223.6.6.6。另阿里的国内镜像也很快，各位可以换啦。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;禁止创建.DS_Store文件&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;defaults write com.apple.desktopservices DSDontWriteNetworkStores true
&lt;/pre&gt;&lt;/div&gt;</content><category term="OSX"></category><category term="config"></category></entry><entry><title>TimeMachine on Archlinux</title><link href="http://blog.onionisi.com/timemachine-on-archlinux.html" rel="alternate"></link><published>2014-05-08T00:00:00+08:00</published><updated>2014-05-08T00:00:00+08:00</updated><author><name>Chong Yang</name></author><id>tag:blog.onionisi.com,2014-05-08:/timemachine-on-archlinux.html</id><summary type="html">&lt;h2&gt;前因&lt;/h2&gt;
&lt;p&gt;之前拿到新电脑很是兴奋，捯饬很比较猛，主要还是想目的就是延长SSD使用寿命，于是乎找了各种措施来减少SSD的写入。万恶的是没有任何备份，当我满心欢喜的禁用了磁盘的日志功能时，心想怎么可能意外断电捏。哪里知道就在第二天浏览淘宝时，打开网页太多导致浏览器卡死了系统，任何操作都不灵了。妈蛋滴，果断强制关机，reboot，老有一个进度条过不来，打客服电话，最后把我弄到检查磁盘的时候，发现磁盘损坏根本修复不了。这时才焕然大悟想起自己关闭了日志，天要亡我，奈何啊，可怜我的资料啊。&lt;/p&gt;
&lt;p&gt;格式化磁盘的时候那叫个恋恋不舍啊，只能忍痛了，在线安装好Marvicks后，看着才出的Yosemite心痒痒，干脆一横心直接升了，这一来二回把我之前节约的写入全糟践了。心里便想着还是要搞个备份才行，Mac不是Linux，什么东西你都能Control，还是小心谨慎为好。&lt;/p&gt;
&lt;h2&gt;后果&lt;/h2&gt;
&lt;p&gt;恋恋不忘，必有回响，总算打起精神准备，把重装新系统以来各种资料备份一下，再丢了就只能掩面而泣了。linux世界的geek们不会让我们失望滴，netatalk就是来抢time capsule生意滴。&lt;/p&gt;
&lt;p&gt;配置文件位置 /etc/afp.conf&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Global]&lt;/span&gt;
&lt;span class="na"&gt;mimic model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;TimeCapsule6,106 …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;h2&gt;前因&lt;/h2&gt;
&lt;p&gt;之前拿到新电脑很是兴奋，捯饬很比较猛，主要还是想目的就是延长SSD使用寿命，于是乎找了各种措施来减少SSD的写入。万恶的是没有任何备份，当我满心欢喜的禁用了磁盘的日志功能时，心想怎么可能意外断电捏。哪里知道就在第二天浏览淘宝时，打开网页太多导致浏览器卡死了系统，任何操作都不灵了。妈蛋滴，果断强制关机，reboot，老有一个进度条过不来，打客服电话，最后把我弄到检查磁盘的时候，发现磁盘损坏根本修复不了。这时才焕然大悟想起自己关闭了日志，天要亡我，奈何啊，可怜我的资料啊。&lt;/p&gt;
&lt;p&gt;格式化磁盘的时候那叫个恋恋不舍啊，只能忍痛了，在线安装好Marvicks后，看着才出的Yosemite心痒痒，干脆一横心直接升了，这一来二回把我之前节约的写入全糟践了。心里便想着还是要搞个备份才行，Mac不是Linux，什么东西你都能Control，还是小心谨慎为好。&lt;/p&gt;
&lt;h2&gt;后果&lt;/h2&gt;
&lt;p&gt;恋恋不忘，必有回响，总算打起精神准备，把重装新系统以来各种资料备份一下，再丢了就只能掩面而泣了。linux世界的geek们不会让我们失望滴，netatalk就是来抢time capsule生意滴。&lt;/p&gt;
&lt;p&gt;配置文件位置 /etc/afp.conf&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Global]&lt;/span&gt;
&lt;span class="na"&gt;mimic model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;TimeCapsule6,106&lt;/span&gt;
&lt;span class="na"&gt;log level&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;default:warn&lt;/span&gt;
&lt;span class="na"&gt;log file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;/var/log/afpd.log&lt;/span&gt;
&lt;span class="na"&gt;hosts allow&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;192.168.1.0/16&lt;/span&gt;

&lt;span class="k"&gt;[TimeMachine]&lt;/span&gt;
&lt;span class="na"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;/path/of/TimeMachine&lt;/span&gt;
&lt;span class="na"&gt;time machine&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;yes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;然后systemd使能并启动netatalk和avahi，进入Time Machine设置搞定啦。&lt;/p&gt;
&lt;h2&gt;one more thing&lt;/h2&gt;
&lt;p&gt;以前我挂载其他电脑文件夹习惯性使用sshfs，Mac需要FUSE OSX依赖安装麻烦，但是netatalk还可以使用共享。
配置文件中加入如下&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Media]&lt;/span&gt;
&lt;span class="na"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;/path/of/media/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;其他linux也可以把afpfs当NFS挂载&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mount_afp &amp;#39;afp://username:password@ipaddr/Media&amp;#39; /mount/path/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;再也不用担心NFS挂载的麻烦啦。&lt;/p&gt;</content><category term="OSX"></category><category term="linux"></category><category term="timemachine"></category></entry><entry><title>工作的一天</title><link href="http://blog.onionisi.com/common_day.html" rel="alternate"></link><published>2013-06-05T00:00:00+08:00</published><updated>2013-06-05T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2013-06-05:/common_day.html</id><summary type="html">&lt;h3&gt;学习依然是头等大事&lt;/h3&gt;
&lt;p&gt;早上就initrd和initramfs进行了一下深入的学习，主要参考文档就是黄敬群老师的博客。打个比方，可能不确切，但是话糙理不糙，init阶段的文件系统就像你高考前的备考，没有这个阶段注定要失败滴。话说黄老师真的是牛X，特别是对于一些系统底层的细节。&lt;/p&gt;
&lt;p&gt;中午波哥吃完午饭就回家准备收麦子了，真的是幸福的码农，请了半个月农忙假。&lt;/p&gt;
&lt;p&gt;下午遇到个奇怪的事情，整理文档发现原来写的小程序demo.py，想试试运行效率，却始终始终执行不了。妈蛋是权限问题么，查看了都没有问题。后边发现是磁盘挂载时忘了&lt;code&gt;exec&lt;/code&gt;了，我的个乖乖，改之遂好。&lt;/p&gt;
&lt;h3&gt;萌生去意&lt;/h3&gt;
&lt;p&gt;下午开会讨论了一下后续EOC工作的分工，心里很复杂，一群照着demo板布PCB的硬件工程师要指挥软件架构，还是好好准备简历吧。&lt;/p&gt;
&lt;h3&gt;新室友到来&lt;/h3&gt;
&lt;p&gt;晚上李佑成准备要搬过来，和他聊了会，家常琐碎。亮点就是他可能有5V2.5A的电源，虽然我需要的是3A，不过明天还是可以试试的硬盘能带起来不能。我手头的cubieboard因为没有合适的电源，那块2.5寸的硬盘已经快积灰了。早就装上了archlinux_arm，还是不错，平时在办公室因为网络的限制，也只能弄来玩玩驱动，配配网络。如若硬盘能带起来，就搞个NAS玩啰。&lt;/p&gt;
&lt;h3&gt;洗洗睡&lt;/h3&gt;
&lt;p&gt;看会十亿消费者就准备睡了 …&lt;/p&gt;</summary><content type="html">&lt;h3&gt;学习依然是头等大事&lt;/h3&gt;
&lt;p&gt;早上就initrd和initramfs进行了一下深入的学习，主要参考文档就是黄敬群老师的博客。打个比方，可能不确切，但是话糙理不糙，init阶段的文件系统就像你高考前的备考，没有这个阶段注定要失败滴。话说黄老师真的是牛X，特别是对于一些系统底层的细节。&lt;/p&gt;
&lt;p&gt;中午波哥吃完午饭就回家准备收麦子了，真的是幸福的码农，请了半个月农忙假。&lt;/p&gt;
&lt;p&gt;下午遇到个奇怪的事情，整理文档发现原来写的小程序demo.py，想试试运行效率，却始终始终执行不了。妈蛋是权限问题么，查看了都没有问题。后边发现是磁盘挂载时忘了&lt;code&gt;exec&lt;/code&gt;了，我的个乖乖，改之遂好。&lt;/p&gt;
&lt;h3&gt;萌生去意&lt;/h3&gt;
&lt;p&gt;下午开会讨论了一下后续EOC工作的分工，心里很复杂，一群照着demo板布PCB的硬件工程师要指挥软件架构，还是好好准备简历吧。&lt;/p&gt;
&lt;h3&gt;新室友到来&lt;/h3&gt;
&lt;p&gt;晚上李佑成准备要搬过来，和他聊了会，家常琐碎。亮点就是他可能有5V2.5A的电源，虽然我需要的是3A，不过明天还是可以试试的硬盘能带起来不能。我手头的cubieboard因为没有合适的电源，那块2.5寸的硬盘已经快积灰了。早就装上了archlinux_arm，还是不错，平时在办公室因为网络的限制，也只能弄来玩玩驱动，配配网络。如若硬盘能带起来，就搞个NAS玩啰。&lt;/p&gt;
&lt;h3&gt;洗洗睡&lt;/h3&gt;
&lt;p&gt;看会十亿消费者就准备睡了，明天见。&lt;/p&gt;</content><category term="daily"></category><category term="work"></category></entry><entry><title>13年年中记事</title><link href="http://blog.onionisi.com/notes_of_2013.html" rel="alternate"></link><published>2013-06-04T00:00:00+08:00</published><updated>2013-06-04T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2013-06-04:/notes_of_2013.html</id><summary type="html">&lt;h3&gt;时光飞逝，忆过往&lt;/h3&gt;
&lt;p&gt;看着dropbox里同步过来的文章&lt;br&gt;
都是去年这个时候的&lt;br&gt;
很久都没有详细记录一下自己&lt;br&gt;
让我想想这快一年的时间&lt;br&gt;
都有些什么事情发生&lt;br&gt;
不要让他变成记忆真空&lt;br&gt;
时间真是快啊&lt;br&gt;
又要高考了&lt;br&gt;
总是想起自己高考的时候&lt;/p&gt;
&lt;h3&gt;苦乐交加，年相似&lt;/h3&gt;
&lt;p&gt;去年六月的也是如此 &lt;br&gt;
光猫的案子不了了之  &lt;br&gt;
陆续开始EOC的工作  &lt;br&gt;
包括Mstar500和AR74&lt;br&gt;
9月份决定买车&lt;br&gt;
红色bravo&lt;br&gt;
为手续和车款奔波&lt;br&gt;
下半年自己开始基于8198和7410做方案&lt;br&gt;
要求元旦搞定时间明显很紧&lt;br&gt;
各种加班与吹促，烦&lt;br&gt;
后北研介入重头来过&lt;br&gt;
1月份出差北京联合开发&lt;br&gt;
遭遇毒物，北京咳&lt;br&gt;
冬季的北京萧肃&lt;br&gt;
又触发了刚毕业的情景&lt;br&gt;
独自一人在北京工作的心酸&lt;br&gt;
年前回川&lt;br&gt;
热闹的春节&lt;br&gt;
但还是觉得少点什么 &lt;/p&gt;
&lt;h3&gt;忙中偷乐，境不同&lt;/h3&gt;
&lt;p&gt;年后Judy开始忙碌&lt;br&gt;
CPA考试在即&lt;br&gt;
5月要go aboard&lt;br&gt;
后勤保障要搞好&lt;br&gt;
第一关签证&lt;br&gt;
成都美使馆4号窗口的高个白人&lt;br&gt;
不太近人情&lt;br&gt;
成为我们的梦魇&lt;br&gt;
感谢周哥和姜猪的招待&lt;br&gt;
多少缓和了一点我们失落的情绪&lt;br&gt;
舒服的春日里油菜花和莘夷花&lt;br&gt;
迎来送往了各位来访的亲友&lt;br&gt;
二签准备十足 …&lt;/p&gt;</summary><content type="html">&lt;h3&gt;时光飞逝，忆过往&lt;/h3&gt;
&lt;p&gt;看着dropbox里同步过来的文章&lt;br&gt;
都是去年这个时候的&lt;br&gt;
很久都没有详细记录一下自己&lt;br&gt;
让我想想这快一年的时间&lt;br&gt;
都有些什么事情发生&lt;br&gt;
不要让他变成记忆真空&lt;br&gt;
时间真是快啊&lt;br&gt;
又要高考了&lt;br&gt;
总是想起自己高考的时候&lt;/p&gt;
&lt;h3&gt;苦乐交加，年相似&lt;/h3&gt;
&lt;p&gt;去年六月的也是如此 &lt;br&gt;
光猫的案子不了了之  &lt;br&gt;
陆续开始EOC的工作  &lt;br&gt;
包括Mstar500和AR74&lt;br&gt;
9月份决定买车&lt;br&gt;
红色bravo&lt;br&gt;
为手续和车款奔波&lt;br&gt;
下半年自己开始基于8198和7410做方案&lt;br&gt;
要求元旦搞定时间明显很紧&lt;br&gt;
各种加班与吹促，烦&lt;br&gt;
后北研介入重头来过&lt;br&gt;
1月份出差北京联合开发&lt;br&gt;
遭遇毒物，北京咳&lt;br&gt;
冬季的北京萧肃&lt;br&gt;
又触发了刚毕业的情景&lt;br&gt;
独自一人在北京工作的心酸&lt;br&gt;
年前回川&lt;br&gt;
热闹的春节&lt;br&gt;
但还是觉得少点什么 &lt;/p&gt;
&lt;h3&gt;忙中偷乐，境不同&lt;/h3&gt;
&lt;p&gt;年后Judy开始忙碌&lt;br&gt;
CPA考试在即&lt;br&gt;
5月要go aboard&lt;br&gt;
后勤保障要搞好&lt;br&gt;
第一关签证&lt;br&gt;
成都美使馆4号窗口的高个白人&lt;br&gt;
不太近人情&lt;br&gt;
成为我们的梦魇&lt;br&gt;
感谢周哥和姜猪的招待&lt;br&gt;
多少缓和了一点我们失落的情绪&lt;br&gt;
舒服的春日里油菜花和莘夷花&lt;br&gt;
迎来送往了各位来访的亲友&lt;br&gt;
二签准备十足&lt;br&gt;
结果材料都没用到&lt;br&gt;
反而就工作聊了聊&lt;br&gt;
顺利拿到签证&lt;br&gt;
之后开始各种准备&lt;br&gt;
机票酒店租车证件请假&lt;br&gt;
最主要就是路线&lt;br&gt;
纠结很多但是时间有限  &lt;/p&gt;
&lt;h3&gt;身在异国，思未来&lt;/h3&gt;
&lt;p&gt;到了Cleveland等到考完试&lt;br&gt;
才正在开始tour&lt;br&gt;
Niagara Fall&lt;br&gt;
Los Angeles&lt;br&gt;
Grand Canyon&lt;br&gt;
Yosemite&lt;br&gt;
Las Vegas&lt;br&gt;
San Jose&lt;br&gt;
Standford&lt;br&gt;
California No.1 Road&lt;br&gt;
各种motel&lt;br&gt;
各种蓝天白云&lt;br&gt;
各种皮卡&lt;br&gt;
各种海岸线&lt;br&gt;
出来走走看看还是相当有必要&lt;br&gt;
时间有些赶&lt;br&gt;
很多地方没来得及仔细欣赏&lt;br&gt;
也感受到了差异与差距&lt;br&gt;
回来工作有所变动&lt;br&gt;
目前正在适应新环境&lt;br&gt;
同时做好相应的准备&lt;br&gt;
时不我待，fighting！&lt;/p&gt;</content><category term="daily"></category><category term="travel"></category></entry><entry><title>stat and close()</title><link href="http://blog.onionisi.com/stat-and-close.html" rel="alternate"></link><published>2012-06-20T00:00:00+08:00</published><updated>2012-06-20T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2012-06-20:/stat-and-close.html</id><summary type="html">&lt;h1&gt;file stat and file close&lt;/h1&gt;
&lt;h2&gt;file stat&lt;/h2&gt;
&lt;p&gt;中午吃饭的时候突然聊起了权限，笑777是bus，有点混淆stat的结构了，下午回来看了stat.h&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;// 出自bits/stat.h
#define __S_ISUID   04000   /* Set user ID on execution.  */
#define __S_ISGID   02000   /* Set group ID on execution.  */
#define __S_ISVTX   01000   /* Save swapped text after use (sticky).  */   
#define __S_IREAD   0400    /* Read by owner.  */ 
#define __S_IWRITE  0200    /* Write …&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;h1&gt;file stat and file close&lt;/h1&gt;
&lt;h2&gt;file stat&lt;/h2&gt;
&lt;p&gt;中午吃饭的时候突然聊起了权限，笑777是bus，有点混淆stat的结构了，下午回来看了stat.h&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;// 出自bits/stat.h
#define __S_ISUID   04000   /* Set user ID on execution.  */
#define __S_ISGID   02000   /* Set group ID on execution.  */
#define __S_ISVTX   01000   /* Save swapped text after use (sticky).  */   
#define __S_IREAD   0400    /* Read by owner.  */ 
#define __S_IWRITE  0200    /* Write by owner.  */
#define __S_IEXEC   0100    /* Execute by owner.  */

// 出自sys/stat.h 
#define S_ISUID __S_ISUID   /* Set user ID on execution.  */
#define S_ISGID __S_ISGID   /* Set group ID on execution.  */

#if defined __USE_BSD || defined __USE_MISC || defined __USE_XOPEN
/* Save swapped text after use (sticky bit).  This is pretty well obsolete.  */
# define S_ISVTX    __S_ISVTX
#endif

#define S_IWUSR __S_IWRITE  /* Write by owner.  */
#define S_IXUSR __S_IEXEC   /* Execute by owner.  */
/* Read, write, and execute by owner.  */
#define S_IRWXU (__S_IREAD|__S_IWRITE|__S_IEXEC)

#define S_IRGRP (S_IRUSR &amp;amp;gt;&amp;amp;gt; 3)  /* Read by group.  */
#define S_IWGRP (S_IWUSR &amp;amp;gt;&amp;amp;gt; 3)  /* Write by group.  */
#define S_IXGRP (S_IXUSR &amp;amp;gt;&amp;amp;gt; 3)  /* Execute by group.  */
/* Read, write, and execute by group.  */
#define S_IRWXG (S_IRWXU &amp;amp;gt;&amp;amp;gt; 3)

#define S_IROTH (S_IRGRP &amp;amp;gt;&amp;amp;gt; 3)  /* Read by others.  */
#define S_IWOTH (S_IWGRP &amp;amp;gt;&amp;amp;gt; 3)  /* Write by others.  */
#define S_IXOTH (S_IXGRP &amp;amp;gt;&amp;amp;gt; 3)  /* Execute by others.  */
/* Read, write, and execute by others.  */
#define S_IRWXO (S_IRWXG &amp;amp;gt;&amp;amp;gt; 3)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;另外还有就是lsattr的那一串属性，大伙知道是怎么来的不？&lt;/p&gt;
&lt;h2&gt;file close&lt;/h2&gt;
&lt;p&gt;下午上stack_over_flow发现一个问题，Why do I have to use close() to close a file？&lt;a href="http://stackoverflow.com/questions/11095474/why-do-i-have-to-use-close-to-close-a-file"&gt;链接在此啊&lt;/a&gt;
热情的筒子们回答得很热烈，但是其中有个哥们觉得他们有些人说的有问题，就是关于close到底处理不处理数据写回到磁盘的操作，我也比较懵，还写了小程序测试，晕，还得出是要回写的结论，结果后边在close的man手册里边的NOTE发现如下一段话。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A  successful  close does not guarantee that the data has been successfully saved to disk, as the kernel defers writes.  It is not common for a file
system to flush the buffers when the stream is closed.  If you need to be sure that the data is physically stored use fsync(2).  (It will depend  on
the disk hardware at this point.)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;所以要感谢那位执着的哥们。&lt;/p&gt;</content><category term="linux C"></category><category term="filesystem"></category></entry><entry><title>the proxy of Ubuntu</title><link href="http://blog.onionisi.com/proxy-of-ubuntu.html" rel="alternate"></link><published>2012-05-17T00:00:00+08:00</published><updated>2012-05-17T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2012-05-17:/proxy-of-ubuntu.html</id><summary type="html">&lt;h1&gt;ubuntu的代理&lt;/h1&gt;
&lt;p&gt;办公室的网络总是那么不给力，每个所部各分了一个IP能够上外网，我们只能用代理
来凑合上网了。&lt;/p&gt;
&lt;h2&gt;全局代理&lt;/h2&gt;
&lt;p&gt;ubuntu的全局代理保存在/etc/enviroment，如果是使用gnome桌面的同志可以直接
通过图形界面进行操作，最近办公室的同事都流行轻量且不过太简单的xfce，没有
这个直接的功能，还是操作文件来的快捷。&lt;/p&gt;
&lt;h2&gt;apt代理&lt;/h2&gt;
&lt;p&gt;之前我还以为他直接用的环境变量的全局值，结果事实证明我错了，额还是没有apt
（聪明）聪明啊，他的代理在他的配置文件里，打开就能看见，路径就不用说了吧&lt;/p&gt;
&lt;h2&gt;其他代理&lt;/h2&gt;
&lt;p&gt;wget这个老当亦壮的东东也能在配置文件中设置代理，各位看官自行打开做相应更改
便行。&lt;/p&gt;
&lt;p&gt;其实这些软件设不设代理都不重要，只要你配好了proxychains，再来个行头的自行
插入proxychains，呵呵...自行放狗搜搜&lt;/p&gt;
&lt;h2&gt;吐槽&lt;/h2&gt;
&lt;p&gt;升了12.04的系统没多大感觉，本来本人又不用unity，口味越发清淡，想往WM转了，
之前整了个#！，也没时间玩，最近项目空闲点了，把超级本的arch也好好配配。&lt;/p&gt;
&lt;p&gt;PS:主要是来冒个泡，很久没更新了，另入了kindle3，webos的东东，玩着还有意思 …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;ubuntu的代理&lt;/h1&gt;
&lt;p&gt;办公室的网络总是那么不给力，每个所部各分了一个IP能够上外网，我们只能用代理
来凑合上网了。&lt;/p&gt;
&lt;h2&gt;全局代理&lt;/h2&gt;
&lt;p&gt;ubuntu的全局代理保存在/etc/enviroment，如果是使用gnome桌面的同志可以直接
通过图形界面进行操作，最近办公室的同事都流行轻量且不过太简单的xfce，没有
这个直接的功能，还是操作文件来的快捷。&lt;/p&gt;
&lt;h2&gt;apt代理&lt;/h2&gt;
&lt;p&gt;之前我还以为他直接用的环境变量的全局值，结果事实证明我错了，额还是没有apt
（聪明）聪明啊，他的代理在他的配置文件里，打开就能看见，路径就不用说了吧&lt;/p&gt;
&lt;h2&gt;其他代理&lt;/h2&gt;
&lt;p&gt;wget这个老当亦壮的东东也能在配置文件中设置代理，各位看官自行打开做相应更改
便行。&lt;/p&gt;
&lt;p&gt;其实这些软件设不设代理都不重要，只要你配好了proxychains，再来个行头的自行
插入proxychains，呵呵...自行放狗搜搜&lt;/p&gt;
&lt;h2&gt;吐槽&lt;/h2&gt;
&lt;p&gt;升了12.04的系统没多大感觉，本来本人又不用unity，口味越发清淡，想往WM转了，
之前整了个#！，也没时间玩，最近项目空闲点了，把超级本的arch也好好配配。&lt;/p&gt;
&lt;p&gt;PS:主要是来冒个泡，很久没更新了，另入了kindle3，webos的东东，玩着还有意思，
哪天实在是闲着没事，在分享个心得。&lt;/p&gt;</content><category term="system"></category><category term="skill"></category><category term="linux"></category><category term="distro"></category></entry><entry><title>"旧文翻新之LFS和我第一次"</title><link href="http://blog.onionisi.com/LFS_build_process.html" rel="alternate"></link><published>2012-04-18T00:00:00+08:00</published><updated>2012-04-18T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2012-04-18:/LFS_build_process.html</id><summary type="html">&lt;p&gt;此文乃去年上班闲暇之余，作为深入学习linux之用，发表于内部服务器，今转过来以示纪念。当中各种陋见只怕贻笑大方了，若不慎入眼还望海涵。&lt;/p&gt;
&lt;h2&gt;任务综述&lt;/h2&gt;
&lt;p&gt;断断续续折腾近两周了今天我的LFS已经启动起来了啊，呵呵。。。&lt;/p&gt;
&lt;p&gt;HOST=Ubuntu 2.6.35
TARGET=LFS 6.7&lt;/p&gt;
&lt;p&gt;最新发布的 LFS 是 6.8，好像就在我决定开始弄6.7的那天起发布的&lt;/p&gt;
&lt;p&gt;LFS的项目有好几个，LFS是最基本的，完成之后也只是个最最基础的系统，要想更顺手更丰富的就有BLFS，是基于LFS的，之后还有更进阶的 HLFS&lt;/p&gt;
&lt;p&gt;还有CLFS和ALFS，C 就是 Cross交叉编译的，A 就是Auto，用脚本自动的实现的&lt;/p&gt;
&lt;p&gt;为了好好学习，我还是老老实实 step by step来吧 &lt;/p&gt;
&lt;p&gt;手册其实写得相当详尽，但难免有自己手动的时候有事物，另外手册对原码包的操作都只提了一下，有些地方还需要注意&lt;/p&gt;
&lt;p&gt;比较麻烦的是就是编译工具链的时候，其中GCC …&lt;/p&gt;</summary><content type="html">&lt;p&gt;此文乃去年上班闲暇之余，作为深入学习linux之用，发表于内部服务器，今转过来以示纪念。当中各种陋见只怕贻笑大方了，若不慎入眼还望海涵。&lt;/p&gt;
&lt;h2&gt;任务综述&lt;/h2&gt;
&lt;p&gt;断断续续折腾近两周了今天我的LFS已经启动起来了啊，呵呵。。。&lt;/p&gt;
&lt;p&gt;HOST=Ubuntu 2.6.35
TARGET=LFS 6.7&lt;/p&gt;
&lt;p&gt;最新发布的 LFS 是 6.8，好像就在我决定开始弄6.7的那天起发布的&lt;/p&gt;
&lt;p&gt;LFS的项目有好几个，LFS是最基本的，完成之后也只是个最最基础的系统，要想更顺手更丰富的就有BLFS，是基于LFS的，之后还有更进阶的 HLFS&lt;/p&gt;
&lt;p&gt;还有CLFS和ALFS，C 就是 Cross交叉编译的，A 就是Auto，用脚本自动的实现的&lt;/p&gt;
&lt;p&gt;为了好好学习，我还是老老实实 step by step来吧 &lt;/p&gt;
&lt;p&gt;手册其实写得相当详尽，但难免有自己手动的时候有事物，另外手册对原码包的操作都只提了一下，有些地方还需要注意&lt;/p&gt;
&lt;p&gt;比较麻烦的是就是编译工具链的时候，其中GCC Glibc Binutils这三兄弟相当关键，先是要用他们编译出编译工具链的编译环境，然后再用他们出来的工具链编译整个儿系统&lt;/p&gt;
&lt;p&gt;这三兄弟要来回折腾三下，其中的Gcc Glibc尤为关键，也容易出错&lt;/p&gt;
&lt;p&gt;一般的源码安装方式为 ./configure &amp;amp;&amp;amp; make &amp;amp;&amp;amp; make install&lt;/p&gt;
&lt;p&gt;在LFS中由于特定的版本和包相互之间的依赖，所以在配置之前还会patch上相应的补丁，用 sed 修改某些配置文件 &lt;/p&gt;
&lt;p&gt;另外比较重要的就是关于分区，权限以及命令执行路径的问题，
分区看个人喜好而定，我的磁盘空间不多，挤了5G出来直接挂/，swap和HOST共用，有条件把盘分细点最好
新建一个用户，重新配置他的环境变量一系列，特别涉及到 PATH ，为的都是要和HOST分开从而使用自己新编译的工具链&lt;/p&gt;
&lt;p&gt;其中关于 PATH ，他的几次变化相当相当有里程碑意义啊&lt;/p&gt;
&lt;p&gt;切记！！！！！！！！！每次reboot之后一定要重新挂载你的分区啊，或者直接写进 fstab 
不然你就悲剧了，邮件组就有这样的兄弟，看得我扼腕叹息啊&lt;/p&gt;
&lt;p&gt;最后就是关于包的 test ,我认为除了Gcc和Glibc外，其他的没多大必要，而且相当耗时&lt;/p&gt;
&lt;h3&gt;九九八十一难&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;LFS  Gcc Pass1 08.19/2011&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;../gcc-4.5.1/configure --target=$LFS_TGT --prefix=/tools --disable-nls --disable-shared --disable-multilib --disable-decimal-float --disable-threads --disable-libmudflap --disable-libssp --disable-libgomp --enable-languages=c --with-gmp-include=$LFS/sources/gmp --with-gmp-lib=$LFS/sources/gmp/.libs --without-ppl --without-cloog --with-gmp=$LFS/sources/gmp --with-mpfr=$LFS/sources/mpfr --with-mpc=$LFS/sources/mpc --with-mpfr-include=$LFS/sources/mpfr --with-mpfr-lib=$LFS/sources/mpfr/.libs --with-mpc-include=$LFS/sources/mpc --with-mpc-lib=$LFS/sources/mpc/.libs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;要注意的是gmp mpc mpfr这三个math库的包解压之后要放入Gcc的包内，不然会比较悲剧，我之前就在这儿犯了错，然后直接将gmp mpc mpfr安装在HOST上，通过--with-gmp=/usr/local --with-mpfr=/usr/local --with-mpc=/usr/local调用他们的.so，幸好是第一遍，都用主机的环境&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;LFS  Glibc  08.22/2011&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;../glibc-2.12.1/configure --prefix=/tools --host=$LFS_TGT --build=$(../glibc-2.12.1/scripts/config.guess) --disable-profile --enable-add-ons --enable-kernel=2.6.22.5 --with-headers=/tools/include libc_cv_forced_unwind=yes libc_cv_c_cleanup=yes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;In file included from ../sysdeps/unix/sysv/linux/syslog.c:10:0:
../misc/syslog.c: In function '__vsyslog_chk':
../misc/syslog.c:123:1: sorry, unimplemented: inlining failed in call to 'syslog': function body not available
../misc/syslog.c:155:9: sorry, unimplemented: called from here&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这是 make 直接提示的错误，下边是 log 里详细的错误&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;/mnt/lfs/sources/glibc-build/elf/librtld.os: In function &lt;code&gt;print_statistics':
/mnt/lfs/sources/glibc-2.12.1/elf/rtld.c:2842: undefined reference to&lt;/code&gt;__stack_chk_fail_local'
/mnt/lfs/sources/glibc-build/elf/librtld.os: In function &lt;code&gt;process_dl_debug':
/mnt/lfs/sources/glibc-2.12.1/elf/rtld.c:2478: undefined reference to&lt;/code&gt;__stack_chk_fail_local'
/mnt/lfs/sources/glibc-build/elf/librtld.os: In function &lt;code&gt;process_envvars':
/mnt/lfs/sources/glibc-2.12.1/elf/rtld.c:2737: undefined reference to&lt;/code&gt;__stack_chk_fail_local'
/mnt/lfs/sources/glibc-build/elf/librtld.os: In function &lt;code&gt;dl_main':
/mnt/lfs/sources/glibc-2.12.1/elf/rtld.c:2358: undefined reference to&lt;/code&gt;__stack_chk_fail_local'
/mnt/lfs/sources/glibc-build/elf/librtld.os: In function &lt;code&gt;print_search_path':
/mnt/lfs/sources/glibc-2.12.1/elf/dl-load.c:1558: undefined reference to&lt;/code&gt;__stack_chk_fail_local'
/mnt/lfs/sources/glibc-build/elf/librtld.os:/mnt/lfs/sources/glibc-2.12.1/elf/dl-load.c:1808: more undefined references to &lt;code&gt;__stack_chk_fail_local' follow
/usr/bin/ld: /mnt/lfs/sources/glibc-build/elf/ld.so: hidden symbol&lt;/code&gt;__stack_chk_fail_local' isn't defined
/usr/bin/ld: final link failed: Nonrepresentable section on output&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;上邮件列表找了之后发现，有人说是重复编译了，我确实是忘了clean了  ；）...&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The reason: An already compiled xxx.o file which "uses" the __stack_chk_fail_local.&lt;/p&gt;
&lt;p&gt;This is the cause of not compiling the original xxx.cxx file due to performance.&lt;/p&gt;
&lt;p&gt;Solution: make clean and than make&lt;/p&gt;
&lt;p&gt;Hope this helps....
PS: always make clean&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;不过还是不行，我还重新又解压，还是不行，只好继续放狗（google）,终于如下，当时草草看了一下帮助，记得还有个与-U_FORTIFY_SOURCE长的差不多的选项，
也没细看，不知道是神马意思，有知道的童鞋，就谢谢了啊，麻烦告知一声&lt;/p&gt;
&lt;p&gt;原手册：echo "CFLAGS  += -march=i686 -mtune=native" &amp;gt;&amp;gt; configparms
创建文件：echo "CFLAGS  += -march=i686 -mtune=native -U_FORTIFY_SOURCE" &amp;gt;&amp;gt; configparms&lt;/p&gt;
&lt;p&gt;这句据说容易出错，特摘录再次，以便copy             另手册对sed疼爱有加，故童鞋门要多多熟悉&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;LFS_TGT-gcc&lt;/span&gt; &lt;span class="nt"&gt;-dumpspecs&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;sed&lt;/span&gt; &lt;span class="nt"&gt;-e&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;s@/lib\(64\)\?/ld@/tools&amp;amp;amp;@g&amp;#39;&lt;/span&gt; &lt;span class="nt"&gt;-e&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/^\*cpp:$/{n;s,$, -isystem /tools/include,}&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;SPECS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;p&gt;LFS  Gcc - pass2  08.23/2011&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;CC=&amp;quot;$LFS_TGT-gcc -B/tools/lib/&amp;quot; AR=$LFS_TGT-ar RANLIB=$LFS_TGT-ranlib ../gcc-4.5.1/configure --prefix=/tools --with-local-prefix=/tools --enable-clocale=gnu --enable-shared --enable-threads=posix --enable-__cxa_atexit --enable-languages=c,c++ --disable-libstdcxx-pch --disable-multilib --disable-bootstrap --disable-libgomp --with-gmp-include=$(pwd)/gmp --with-gmp-lib=$(pwd)/gmp/.libs --without-ppl --without-cloog
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;正&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;CC=&amp;quot;$LFS_TGT-gcc -B/tools/lib/&amp;quot; AR=$LFS_TGT-ar RANLIB=$LFS_TGT-ranlib ../gcc-4.5.1/configure --prefix=/tools --with-local-prefix=/tools --enable-clocale=gnu --enable-shared --enable-threads=posix --enable-__cxa_atexit --enable-languages=c,c++ --disable-libstdcxx-pch --disable-multilib --disable-bootstrap --disable-libgomp --without-ppl --without-cloog --with-gmp=/usr/local --with-mpfr=/usr/local --with-mpc=/usr/local
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;误&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;鄙人延用第一次的命令，果然错你没商量，谨记记得包的位置，因为此时已经是Pass 2,用的是之前编译出来的零时工具链&lt;/p&gt;
&lt;p&gt;这句也是不好输入，留作印刷&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sed &amp;#39;s/^T_CFLAGS =$/&amp;amp;amp; -fomit-frame-pointer/&amp;#39; gcc/Makefile.in.tmp &amp;amp;gt; gcc/Makefile.in
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;p&gt;LFS  chroot  08.25/2011&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mount /dev/sda13 $LFS &amp;amp;amp;&amp;amp;amp; mount -v --bind     /dev    $LFS/dev &amp;amp;amp;&amp;amp;amp; mount -vt devpts    devpts  $LFS/dev/pts &amp;amp;amp;&amp;amp;amp; mount -vt tmpfs     shm     $LFS/dev/shm &amp;amp;amp;&amp;amp;amp; mount -vt proc      proc    $LFS/proc &amp;amp;amp;&amp;amp;amp; mount -vt sysfs     sysfs   $LFS/sys
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这里很关键，这是每次重启之后居家旅行必备之指令，我把他们合几为一了
再次提醒，一定要挂载你的磁盘啊，之后就 chroot ，看好这里的 PATH 变啦&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;chroot &amp;quot;$LFS&amp;quot; /tools/bin/env -i HOME=/root TERM=&amp;quot;$TERM&amp;quot; PS1=&amp;#39;\u:\w\$ &amp;#39; PATH=/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin /tools/bin/bash --login +h
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;编译完第6章之后，chroot 的 PATH 还要发生变化，真是变形金刚啊&lt;/p&gt;
&lt;h3&gt;工具链初长成&lt;/h3&gt;
&lt;p&gt;之后再编译进去几个包，我们的完整工具链就好啦，我把我的已经打好包了，有需要的同学可以问我要，就不用经受上边一系列痛苦了&lt;/p&gt;
&lt;p&gt;下边我们就可以开始构建系统啦，一定要小心小心再小心啊，下边就是我两个手误的表现&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;LFS  Glibc  08.25/2011&lt;/p&gt;
&lt;p&gt;编译完 C 库之后有个检验，cc 直接刮掉，吓死我了，这都不过，岂不前功尽弃
翻 log ，细错如下&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;attempt to open /usr/lib/crt1.o succeeded
/usr/lib/crt1.o
attempt to open /usr/lib/crti.o succeeded
/usr/lib/crti.o
attempt to open /tools/lib/gcc/i686-pc-linux-gnu/4.0.3/crtbegin.o succeeded
/tools/lib/gcc/i686-pc-linux-gnu/4.0.3/crtbegin.o
attempt to open /tmp/ccTyfGyo.o succeeded
/tmp/ccTyfGyo.o
attempt to open /tools/lib/gcc/i686-pc-linux-gnu/4.0.3/libgcc.so failed
attempt to open /tools/lib/gcc/i686-pc-linux-gnu/4.0.3/libgcc.a succeeded
attempt to open /tools/lib/gcc/i686-pc-linux-gnu/4.0.3/libgcc_s.so failed
attempt to open /tools/lib/gcc/i686-pc-linux-gnu/4.0.3/libgcc_s.a failed
attempt to open /tools/lib/gcc/i686-pc-linux-gnu/4.0.3/../../../../i686-pc-linux-gnu/lib/libgcc_s.so failed
attempt to open /tools/lib/gcc/i686-pc-linux-gnu/4.0.3/../../../../i686-pc-linux-gnu/lib/libgcc_s.a failed
attempt to open /tools/bin/../i686-pc-linux-gnu/lib/libgcc_s.so failed
attempt to open /tools/bin/../i686-pc-linux-gnu/lib/libgcc_s.a failed
attempt to open /tools/i686-pc-linux-gnu/lib/libgcc_s.so failed
attempt to open /tools/i686-pc-linux-gnu/lib/libgcc_s.a failed
attempt to open /usr/lib/libgcc_s.so failed
attempt to open /usr/lib/libgcc_s.a failed
attempt to/tools/lib/gcc/i686-pc-linux-gnu/4.0.3/../../../../i686-pc-linux-gnu/bin/ld: cannot find -lgcc_s
open /lib/libgcc_s.so failed
attempt to open /lib/libgcc_s.a failed
collect2: ld returned 1 exit status&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;查看相应文件，健在
肿么啦，不都有么？为嘛failed
不断放狗，见同错，无人解啊，心灰意冷准备重新编译
遂前往 /usr/bin 查看文件以备删除，无意撞见 .so 混迹于此
大怒，细查之，发现出现如此低级失误，lib bin竟傻傻分不清楚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ln -sv /tools/bin/{bash,cat,echo,pwd,stty} /bin
ln -sv /tools/bin/perl /usr/bin
@@@ 自己路径出错 ^_^
ln -sv /tools/lib/libgcc_s.so{,.1} /usr/lib
ln -sv /tools/lib/libstdc++.so{,.6} /usr/lib
@@@
ln -sv bash /bin/sh
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;p&gt;LFS  Perl  08.25/2011&lt;/p&gt;
&lt;p&gt;perl 应该也是某个神马咚咚敲错了，连 make 都问题连连，我愤而直接Ctrl + c，再 Shift + Ctrl + v&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sed -i -e &amp;quot;s|BUILD_ZLIB\s*= True|BUILD_ZLIB = False|&amp;quot; -e &amp;quot;s|INCLUDE\s*= ./zlib-src|INCLUDE = /usr/include|&amp;quot; -e &amp;quot;s|LIB\s*= ./zlib-src|LIB = /usr/lib|&amp;quot; cpan/Compress-Raw-Zlib/config.in


sh Configure -des -Dprefix=/usr -Dvendorprefix=/usr -Dman1dir=/usr/share/man/man1 -Dman3dir=/usr/share/man/man3 -Dpager=&amp;quot;/usr/bin/less -isR&amp;quot; -Duseshrplib


sed -i -e &amp;#39;s@#ENCRYPT_METHOD DES@ENCRYPT_METHOD MD5@&amp;#39; -e &amp;#39;s@/var/spool/mail@/var/mail@&amp;#39; etc/login.defs

sed -i &amp;#39;s@Sending processes@&amp;amp;amp; configured via /etc/inittab@g&amp;#39; src/init.c

sed -i -e &amp;#39;s/utmpdump wall/utmpdump/&amp;#39; -e &amp;#39;s/mountpoint.1 wall.1/mountpoint.1/&amp;#39; src/Makefile
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;成人礼&lt;/h3&gt;
&lt;p&gt;系统软件编译完后就又要变身了，进而好编辑相应的配置文件，前边提到的 chroot 再度登场，以后就是他唱主角了&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;chroot &amp;quot;$LFS&amp;quot; /usr/bin/env -i HOME=/root TERM=&amp;quot;$TERM&amp;quot; PS1=&amp;#39;\u:\w\$ &amp;#39; PATH=/bin:/usr/bin:/sbin:/usr/sbin /bin/bash --login
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;p&gt;LFS  locale  08.25/2011&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mkdir -pv /usr/lib/locale
localedef -i cs_CZ -f UTF-8 cs_CZ.UTF-8
localedef -i de_DE -f ISO-8859-1 de_DE
localedef -i de_DE@euro -f ISO-8859-15 de_DE@euro
localedef -i de_DE -f UTF-8 de_DE.UTF-8
localedef -i en_HK -f ISO-8859-1 en_HK
localedef -i en_PH -f ISO-8859-1 en_PH
localedef -i en_US -f ISO-8859-1 en_US
localedef -i en_US -f UTF-8 en_US.UTF-8
localedef -i es_MX -f ISO-8859-1 es_MX
localedef -i fa_IR -f UTF-8 fa_IR
localedef -i fr_FR -f ISO-8859-1 fr_FR
localedef -i fr_FR@euro -f ISO-8859-15 fr_FR@euro
localedef -i fr_FR -f UTF-8 fr_FR.UTF-8
localedef -i it_IT -f ISO-8859-1 it_IT
localedef -i ja_JP -f EUC-JP ja_JP
localedef -i tr_TR -f UTF-8 tr_TR.UTF-8
localedef -i zh_CN -f GB18030 zh_CN.GB18030

cp -v --remove-destination /usr/share/zoneinfo/Asia/Chongqing /etc/localtime
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;时区我们肯定选重庆的啦&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;LFS  grub  09.01/2011&lt;/p&gt;
&lt;p&gt;grub 现在的配置文件是 grub.cfg ,不再是 menu.lst 了，我没有安装 grub, 只是用grub-mkconfig -o /boot/grub/grub.cfg生成了配置文件&lt;/p&gt;
&lt;p&gt;然后将其中引导系统那一段 copy 到 HOST 的/boot/grub/grub.cfg中了。&lt;/p&gt;
&lt;p&gt;注意下边的那段话，是一位仁兄在LFS的邮件列表里说的，这位就是那位悲摧的筒子，没有挂载相应分区，做完之后启动不了才发现，太坑爹了......................&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;You should not be rebooting from chroot.

If you followed the book precisely, the kernel should be on 
(hda0,3)/boot, but GRUB needs to be able to find menu.cfg.  That&amp;#39;s why I 
recommend installing /boot on a partition of about 100M by itself.  All 
distros can then access that.

You should be using the procedures in the book&amp;#39;s Section 8.4.3 to test:

First exit chroot and sudo /sbin/reboot.  Then go to the GRUB2 command 
line and run:

grub&amp;amp;gt; ls (hd0,3)/boot

This should list your kernels.

Then you should just do:

linux (hd0,3)/boot/my-kernel-name root=/dev/hda3
boot

I note that the instructions in the book can be misread.  8.4.3 says:
&amp;quot;you will need to exit the chroot environment and re-enter it to finish 
the few remaining portions of the book.&amp;quot;   What that means is that you 
ned to return to your host system for the instructions in 8.4.3 and 
return back to chroot for section 8.4.4 until section 9.3.

   -- Bruce

1) Yes, you are right,
ls (hd0,msdos3)/
and
ls (hd0,3)/
give the same output, that is
lost+found sources sys

2) The mount command gives the following:

&amp;quot;
/dev/sda1 on / type ext4 (rw,errors=remount-ro,commit=0)
proc on /proc type proc (rw,noexec,nosuid,nodev)
none on /sys type sysfs (rw,noexec,nosuid,nodev)
fusectl on /sys/fs/fuse/connections type fusectl (rw)
none on /sys/kernel/debug type debugfs (rw)
none on /sys/kernel/security type securityfs (rw)
none on /dev type devtmpfs (rw,mode=0755)
none on /dev/pts type devpts (rw,noexec,nosuid,gid=5,mode=0620)
none on /dev/shm type tmpfs (rw,nosuid,nodev)
none on /var/run type tmpfs (rw,nosuid,mode=0755)
none on /var/lock type tmpfs (rw,noexec,nosuid,nodev)
&amp;quot;

I am sure that I mounted /dev/sda3 on /mnt/lfs by running the command
sudo mount -v -t ext3 /dev/sda3 $LFS
The problem though is that I rebooted the system several times without
remounting it manually or automatically through /etc/fstab.
If that&amp;#39;s one of the mistakes I made, then I will have to do go through all
the chapters of the book from the beginning, right...?

3) Yes, you are right, I got a bit confused in section 8.4.3, where I found
the sentence &amp;quot;To accomplish this, you will need to exit the chroot
environment and re-enter it to finish the few remaining portions of the
book&amp;quot; to be a bit obscure. However, I went back to it and in fact I think
that a careful reader will probably understand what is meant there.

I am very much afraid I will have to do everything from the beginning due to
the fact that the /dev/sda3 was not mounted throughout the installation. In
this case, I will take into account your remark and will install /boot in a
separate partition to make it accessible by all operating systems, that is
Kubuntu and LFS. I can&amp;#39;t believe I have to do everything from scratch
again... thanks very much for your help though, your remarks helpded me
understand a few mistakes of mine.

Theo
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;在 grub 之前，kernel 的配置和编译也是相当杀脑细胞滴，我为了尽量将内核编译小点，尽量去除一些看着不沾边的设备，特别是驱动那，没想到结果就那出问题&lt;/p&gt;
&lt;p&gt;有两次都是kernel panic，cannot open root device，于是乎我就把 HOST 的 kernel config 拷贝了过去对 driver 完全没有动刀，其他地方就针对&lt;/p&gt;
&lt;p&gt;CPU 以及 FS 做了改动，去了IPv6，俗话说事不过三嘛，还好启动起来了，只是网卡不知道为什么启动失败了，下来还要在探究一下&lt;/p&gt;
&lt;p&gt;然后就要开始 BLFS 的征途了&lt;/p&gt;
&lt;h2&gt;结语&lt;/h2&gt;
&lt;p&gt;BLFS后边由于上项目了，也拖了很久结果连openssl都还没有编译现在7.1都出来了，呵呵...有机会再玩一把，现在挺喜欢这种轻便快捷定制型儿的了&lt;/p&gt;</content><category term="system"></category><category term="linux"></category><category term="compile"></category></entry><entry><title>oh-my-zsh的芯</title><link href="http://blog.onionisi.com/oh-my-zsh.html" rel="alternate"></link><published>2012-04-17T00:00:00+08:00</published><updated>2012-04-17T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2012-04-17:/oh-my-zsh.html</id><summary type="html">&lt;p&gt;用zsh有一段时间了，前段时间在github上找见了这个神奇的项目，试用起来果然还是
很有爱。但是之前的配置已经有我比较熟悉的快捷键，所以还是要改造一番，美其名曰
本地化。&lt;/p&gt;
&lt;h2&gt;主配置.zshrc&lt;/h2&gt;
&lt;p&gt;主配置很简洁，主要功能就是选主题选插件，形式各样的千奇百怪的prompt，各种功能
不同的插件，可根据发行版，版本控制工具进行选择，大家各取所需。
这也就是vim、firefox这些软件强大的原因---有广大的同志还开发插件！所以说群众
的力量是无穷的。&lt;/p&gt;
&lt;p&gt;下边就是主体程序的目录结构：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/home/onionisi/.oh-my-zsh/
|+cache/
|+custom/
|+lib/
|+log/
|+plugins/
|+templates/
|+themes/
|+tools/
|-oh-my-zsh.sh
`-README.textile
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;oh-my-zsh.sh&lt;/h2&gt;
&lt;p&gt;这个脚本才开始真正进入主题。&lt;/p&gt;
&lt;h3&gt;upgrade&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Check for updates on initial load...
if [ &amp;quot;$DISABLE_AUTO_UPDATE …&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;用zsh有一段时间了，前段时间在github上找见了这个神奇的项目，试用起来果然还是
很有爱。但是之前的配置已经有我比较熟悉的快捷键，所以还是要改造一番，美其名曰
本地化。&lt;/p&gt;
&lt;h2&gt;主配置.zshrc&lt;/h2&gt;
&lt;p&gt;主配置很简洁，主要功能就是选主题选插件，形式各样的千奇百怪的prompt，各种功能
不同的插件，可根据发行版，版本控制工具进行选择，大家各取所需。
这也就是vim、firefox这些软件强大的原因---有广大的同志还开发插件！所以说群众
的力量是无穷的。&lt;/p&gt;
&lt;p&gt;下边就是主体程序的目录结构：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/home/onionisi/.oh-my-zsh/
|+cache/
|+custom/
|+lib/
|+log/
|+plugins/
|+templates/
|+themes/
|+tools/
|-oh-my-zsh.sh
`-README.textile
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;oh-my-zsh.sh&lt;/h2&gt;
&lt;p&gt;这个脚本才开始真正进入主题。&lt;/p&gt;
&lt;h3&gt;upgrade&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Check for updates on initial load...
if [ &amp;quot;$DISABLE_AUTO_UPDATE&amp;quot; != &amp;quot;true&amp;quot; ]
then
  /usr/bin/env ZSH=$ZSH zsh $ZSH/tools/check_for_upgrade.sh
fi
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;如果没有禁止自动升级的，首先会upgrade，oh-my-zsh作为一个公共项目，每天的更新
还是挺频繁，从github的图上就能看出来。再来看check_for_upgrade&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;_current_epoch() {&lt;/span&gt;
  &lt;span class="nx"&gt;echo&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;date&lt;/span&gt; &lt;span class="o"&gt;+%&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;60&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;60&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;24&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;_update_zsh_update() {&lt;/span&gt;
  &lt;span class="nx"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LAST_EPOCH=$(_current_epoch)&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="err"&gt;/.zsh-update&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;_upgrade_zsh() {&lt;/span&gt;
  &lt;span class="err"&gt;/usr/bin/env ZSH=$ZSH /bin/sh $ZSH/tools/upgrade.sh&lt;/span&gt;
  &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;update&lt;/span&gt; &lt;span class="nx"&gt;the&lt;/span&gt; &lt;span class="nx"&gt;zsh&lt;/span&gt; &lt;span class="nx"&gt;file&lt;/span&gt;
  &lt;span class="nx"&gt;_update_zsh_update&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;使用了天数来比较，比较有意思，若大于6天就要自己选择了，在upgrade中就主要用
git来pull最近的更新了，办公室的电脑是代理上网的所以我前边加上了proxychains。&lt;/p&gt;
&lt;h3&gt;初始化&lt;/h3&gt;
&lt;p&gt;首先就是要载入一些“库”，呵呵...有个custom可以自定义哦。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# add a function path
fpath=($ZSH/functions $ZSH/completions $fpath)

# Load all of the config files in ~/oh-my-zsh that end in .zsh
# TIP: Add files you don&amp;#39;t want in git to .gitignore
for config_file ($ZSH/lib/*.zsh) source $config_file

# Set ZSH_CUSTOM to the path where your custom config files
# and plugins exists, or else we will use the default custom/
if [[ -z &amp;quot;$ZSH_CUSTOM&amp;quot; ]]; then
    ZSH_CUSTOM=&amp;quot;$ZSH/custom&amp;quot;
fi

is_plugin() {
  local base_dir=$1
  local name=$2
  test -f $base_dir/plugins/$name/$name.plugin.zsh \
    || test -f $base_dir/plugins/$name/_$name
}
# Add all defined plugins to fpath. This must be done
# before running compinit.
for plugin ($plugins); do
  if is_plugin $ZSH_CUSTOM $plugin; then
    fpath=($ZSH_CUSTOM/plugins/$plugin $fpath)
  elif is_plugin $ZSH $plugin; then
    fpath=($ZSH/plugins/$plugin $fpath)
  fi
done
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;keypoint&lt;/h3&gt;
&lt;p&gt;俗话说得好包子好吃不在褶儿上，这配置好用可都在插件里，下边上插件&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Load all of the plugins that were defined in ~/.zshrc
for plugin (&lt;span class="nv"&gt;$plugins&lt;/span&gt;); do
  if [ -f &lt;span class="nv"&gt;$ZSH_CUSTOM&lt;/span&gt;/plugins/&lt;span class="nv"&gt;$plugin&lt;/span&gt;/&lt;span class="nv"&gt;$plugin.plugin.zsh&lt;/span&gt; ]; then
    source &lt;span class="nv"&gt;$ZSH_CUSTOM&lt;/span&gt;/plugins/&lt;span class="nv"&gt;$plugin&lt;/span&gt;/&lt;span class="nv"&gt;$plugin.plugin.zsh&lt;/span&gt;
  elif [ -f &lt;span class="nv"&gt;$ZSH&lt;/span&gt;/plugins/&lt;span class="nv"&gt;$plugin&lt;/span&gt;/&lt;span class="nv"&gt;$plugin.plugin.zsh&lt;/span&gt; ]; then
    source &lt;span class="nv"&gt;$ZSH&lt;/span&gt;/plugins/&lt;span class="nv"&gt;$plugin&lt;/span&gt;/&lt;span class="nv"&gt;$plugin.plugin.zsh&lt;/span&gt;
  fi
done

# Load all of your custom configurations from custom/
for config_file (&lt;span class="nv"&gt;$ZSH_CUSTOM&lt;/span&gt;/*.zsh) source &lt;span class="nv"&gt;$config_file&lt;/span&gt;

# Load the theme
if [ &amp;quot;&lt;span class="nv"&gt;$ZSH_THEME&lt;/span&gt;&amp;quot; = &amp;quot;random&amp;quot; ]
then
  themes=(&lt;span class="nv"&gt;$ZSH&lt;/span&gt;/themes/*zsh-theme)
  N=&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="c1"&gt;#themes[@]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
  ((N=(RANDOM%N)+1))
  RANDOM_THEME=&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
  source &amp;quot;&lt;span class="nv"&gt;$RANDOM_THEME&lt;/span&gt;&amp;quot;
  echo &amp;quot;[oh-my-zsh] Random theme &amp;#39;&lt;span class="nv"&gt;$RANDOM_THEME&lt;/span&gt;&amp;#39; loaded...&amp;quot;
else
  if [ ! &amp;quot;&lt;span class="nv"&gt;$ZSH_THEME&lt;/span&gt;&amp;quot; = &amp;quot;&amp;quot;  ]
  then
    if [ -f &amp;quot;&lt;span class="nv"&gt;$ZSH&lt;/span&gt;/custom/&lt;span class="nv"&gt;$ZSH_THEME.zsh&lt;/span&gt;-theme&amp;quot; ]
    then
      source &amp;quot;&lt;span class="nv"&gt;$ZSH&lt;/span&gt;/custom/&lt;span class="nv"&gt;$ZSH_THEME.zsh&lt;/span&gt;-theme&amp;quot;
    else
      source &amp;quot;&lt;span class="nv"&gt;$ZSH&lt;/span&gt;/themes/&lt;span class="nv"&gt;$ZSH_THEME.zsh&lt;/span&gt;-theme&amp;quot;
    fi
  fi
fi
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;欧欧欧...我觉得我都在粘代码了，还是大神linus说得对RTFSC，同志们还是直接去看
吧，直接明了。&lt;/p&gt;
&lt;p&gt;下一步就是我要把我先前的顺手货拆开再组装上去，未完待续哦...&lt;/p&gt;</content><category term="shell"></category><category term="src"></category><category term="zsh"></category></entry><entry><title>/run的由来</title><link href="http://blog.onionisi.com/linux-run-dir.html" rel="alternate"></link><published>2012-03-27T00:00:00+08:00</published><updated>2012-03-27T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2012-03-27:/linux-run-dir.html</id><summary type="html">&lt;p&gt;熟悉Linux的朋友都知道，在FHS中是没有/run这个顶级目录的。当然运行时的/proc，/sys也不包括在内，这些目录的演变史也算得上是部分的kernel的发展史，尽管Linux的岁数也不大。&lt;/p&gt;
&lt;h2&gt;/run目录的诞生&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;各主要发行版阵营的重要人物讨论了/dev目录被滥用的情况，希望在该问题还没有扩大化前找到解决方案。他们提出了各种方案，但所有方案都归结到一点，/var/run目录不应在/var目录下，它可以提升到根目录下，这是唯一简洁明了的方案。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;事件原委&lt;/h2&gt;
&lt;p&gt;以下文字翻译自Lennart Poetteringu邮件，一名Fedora的开发者，详细解释了原因。&lt;/p&gt;
&lt;p&gt;我在F15中上传了systemd的新版本，它在根目录下创建了/run这个目录。迟早你都会对此感到困惑，所以下面就讲讲它是肿么来的，为虾米要这么做。&lt;/p&gt;
&lt;p&gt;其实这只是一个相当小的变动，但是大伙儿可能会认为这是一个很大的政策变动，所以我觉得还是相当地有必要解释一下：&lt;/p&gt;
&lt;p&gt;在早期启动的程序里，相当一段时间里他们用/dev目录上很多隐藏文件存储运行时数据。第一个文件就是/dev/.udev，随着时间的推移，又逐步增加了/dev/.mdadm，/dev/.systemd，/dev/.mount，dracut，initscripts以及更多的工具。（其他发行版还有更多 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;熟悉Linux的朋友都知道，在FHS中是没有/run这个顶级目录的。当然运行时的/proc，/sys也不包括在内，这些目录的演变史也算得上是部分的kernel的发展史，尽管Linux的岁数也不大。&lt;/p&gt;
&lt;h2&gt;/run目录的诞生&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;各主要发行版阵营的重要人物讨论了/dev目录被滥用的情况，希望在该问题还没有扩大化前找到解决方案。他们提出了各种方案，但所有方案都归结到一点，/var/run目录不应在/var目录下，它可以提升到根目录下，这是唯一简洁明了的方案。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;事件原委&lt;/h2&gt;
&lt;p&gt;以下文字翻译自Lennart Poetteringu邮件，一名Fedora的开发者，详细解释了原因。&lt;/p&gt;
&lt;p&gt;我在F15中上传了systemd的新版本，它在根目录下创建了/run这个目录。迟早你都会对此感到困惑，所以下面就讲讲它是肿么来的，为虾米要这么做。&lt;/p&gt;
&lt;p&gt;其实这只是一个相当小的变动，但是大伙儿可能会认为这是一个很大的政策变动，所以我觉得还是相当地有必要解释一下：&lt;/p&gt;
&lt;p&gt;在早期启动的程序里，相当一段时间里他们用/dev目录上很多隐藏文件存储运行时数据。第一个文件就是/dev/.udev，随着时间的推移，又逐步增加了/dev/.mdadm，/dev/.systemd，/dev/.mount，dracut，initscripts以及更多的工具。（其他发行版还有更多）他们使用这些目录的缘由很简单，总所周知/dev是tmpfs，系统启动后就立即可用。/var/run则只能在启动后半段可用，因为/var可能挂载在某个单独的分区。&lt;/p&gt;
&lt;p&gt;然而/dev始终不是个适合运行时数据存放的地方，因为这些数据不是设备节点，所以他们不属于这个地方。同时，隐藏这些文件对管理员来说是个坏主意。事实上，用户们也不能理解这些数据为什么要存放在/var/run/xxx以及/dev/.yyy，特别是当启动之后，需要使用的一些工具，因为在启动的时候发生在这些目录之间复杂的数据移动。&lt;/p&gt;
&lt;p&gt;此前不同的发行版针对“early-runtime-dir”都采用过不是很完整的解决方案：Debian---&amp;gt;/lib/init/rw, 启动早期挂载的tmpfs;Ubuntu---&amp;gt;/var/run,在/var之前挂载的tmpfs，使用了一些mount特有的丑陋技巧。但大多数软件都回避这个问题，还是继续使用/dev/.xxx。&lt;/p&gt;
&lt;p&gt;在过去的几周里，各大发行版Debian，Suse，Ubuntu以及Fedora阵营(当然还有其他的哈)的主要负责人探讨了这个问题的前因后果，为的就是找到一个最终的解决办法防止/对/dev的滥用以阻止这个问题的不断扩大。有各式各样的建议被提出来，但最终讨论下来发现了一点共识，那就是/var/run不应该挂载在/var下，我们真正需要的一个一级目录/run，这才是真正干净利落的解决方案。但是为什么没有人敢真正实现这个目录，原因就是大伙儿都不想去处理那些与标准对立带来的问题，特别是邮件列表上那些乱七八糟的讨论（就像是这一篇一样）。&lt;/p&gt;
&lt;p&gt;基于这一点，我们觉得我们应当实现大家都认为对的技术解决方案，而不是去规避标准。因此我们实现了他。&lt;/p&gt;
&lt;p&gt;此实现上载后，Fedora和Suse现在已经在使用/run了。Debian的同志们也会在下一版中采纳此建议。Ubuntu同样也同意引入/run。&lt;/p&gt;
&lt;p&gt;Dracut，udev和systemd为了使用/run，已经更新了上游源码，希望mdadm和mount要尽快跟上。&lt;/p&gt;
&lt;p&gt;其实早在几年前Debian的筒子就建议引入/run，甚至还询问LSB的同志，更甚的是居然还得到了一个虽然含糊但却正面的回应。&lt;/p&gt;
&lt;p&gt;那么F15都具体实现了虾米，我们来看看。&lt;/p&gt;
&lt;p&gt;/run是tmpfs，/var/run挂载在上边。/var/lock则挂载在/run/lock上。从现在开始，只有早期启动的程序应当使用/run，之后的程序还是按照FHS/LSB来。那些有相关应用软件包的作者我们都已经通知到了。如果你没有接到我们的任何通知，说明不会影响到你的程序。&lt;/p&gt;
&lt;p&gt;那么这么做的好处捏？&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;现在只使用一个tmpfs，同时挂载/run，/var/lock和/var/run三个目录，减少了tmpfs的占用。&lt;/li&gt;
&lt;li&gt;所有的运行时数据都在同一个地方。systemd,udev,dracut的数据都在/run和/var/run下边，方便查看易于管理。这让你第一次有机会只需要"ls /var/run"就能看见这些重要工具对于数据的处理。&lt;/li&gt;
&lt;li&gt;数据无处遁形。管理员掌控一切，神马都在/var/run和/run里边，再也没有点藏文件。&lt;/li&gt;
&lt;li&gt;我们标准化了"early-runtime-dir"在所有主流发行版的方案。&lt;/li&gt;
&lt;li&gt;开发的同志们也会很爽，不用在滥用/dev鸟。&lt;/li&gt;
&lt;li&gt;一级目录的名称显式表明了属性。各目录树下的文件夹属性保持一致，比如/var---&amp;gt;"persistant runtime data"，/run---&amp;gt;"volatile runtime data"，/etc---&amp;gt;"persistant system config data"等等。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这就是目前在F15中实现的，在F16中我们会做一个小改动：/var/lock和/var/run会成为软链接指向/run/lock和/run，于是我们就不用采用直接挂载这种不优雅的方式，而且管理也不方便。因为软链接和RPM的隐讳关联，我们暂不对F15做如此更改。&lt;/p&gt;
&lt;p&gt;我们实现这个方案实际需要的代码改动很小（基本上就是用新的tmpfs挂载/var/run以及/var/lock取代原来的绑定挂载），这也是我们会选择在F15周期这么后期做这件事。&lt;/p&gt;
&lt;h2&gt;个人感想&lt;/h2&gt;
&lt;p&gt;话说Fedora真的是很有创新的版本，新的F17还会有D语言的开发环境，另目前一直在Ubuntu上，一直没有机会感受systemd的机会啊，前段时间倒是工作需要装了一个F14，坑爹的连源都撤了，近期有打算弄弄FreeBSD，换换环境。&lt;/p&gt;
&lt;p&gt;这篇文章战线还挺长，0406才截稿啊，blog再不写就可惜我倒腾了，呵呵......&lt;/p&gt;</content><category term="fs"></category><category term="linux"></category><category term="distro"></category><category term="trans"></category></entry><entry><title>Recently</title><link href="http://blog.onionisi.com/recently.html" rel="alternate"></link><published>2012-03-21T00:00:00+08:00</published><updated>2012-03-21T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2012-03-21:/recently.html</id><summary type="html">&lt;h2&gt;spring come&lt;/h2&gt;
&lt;p&gt;这是我在绵阳的第一个春天，今天又降温了，下班回宿舍的路上还是有一些些冷，食堂
依然是那么车水马龙。本来照例今天应该是要会江油的，可是亲爱的在上课，天气又不
好，周一周二晚上也没做什么事情，趁着今晚把最近的资料整整。&lt;/p&gt;
&lt;p&gt;博客都说要弄很久了，之前说用WP，后边干脆就用jekyll，虽然我不懂ruby，但是看着
这么简洁和方便，确实很喜欢，先写着，慢慢搭，反正用md写很舒服，用git管理更不
用说。&lt;/p&gt;
&lt;h2&gt;周末&lt;/h2&gt;
&lt;p&gt;还要追溯到上上周，我们两个又去买了辆自行车，为虾米说“又”捏，because我们之前
去看失恋33天外加逛超市外加吃韩国拌饭的时候，丢了一辆我们很喜欢的“小红”，貌似
蒋雯丽童鞋在某某电视剧里的装备。这回完全是看在春暖花开的面子上，我们想出去骑
游了，加上之前我们单位也在召唤组织骑游and上上上周几个公务员同志策划的出游因
下雨而泡汤。对不起，我的stack够深，跟不上的同志慢慢回溯啊。&lt;/p&gt;
&lt;p&gt;上上周我们很兴奋的骑行去了武都，一个跟龙门town很相似的地方------------灰大！
回来被告知有另外一条羊肠小道，遂决定上周末再此出行。怎料 …&lt;/p&gt;</summary><content type="html">&lt;h2&gt;spring come&lt;/h2&gt;
&lt;p&gt;这是我在绵阳的第一个春天，今天又降温了，下班回宿舍的路上还是有一些些冷，食堂
依然是那么车水马龙。本来照例今天应该是要会江油的，可是亲爱的在上课，天气又不
好，周一周二晚上也没做什么事情，趁着今晚把最近的资料整整。&lt;/p&gt;
&lt;p&gt;博客都说要弄很久了，之前说用WP，后边干脆就用jekyll，虽然我不懂ruby，但是看着
这么简洁和方便，确实很喜欢，先写着，慢慢搭，反正用md写很舒服，用git管理更不
用说。&lt;/p&gt;
&lt;h2&gt;周末&lt;/h2&gt;
&lt;p&gt;还要追溯到上上周，我们两个又去买了辆自行车，为虾米说“又”捏，because我们之前
去看失恋33天外加逛超市外加吃韩国拌饭的时候，丢了一辆我们很喜欢的“小红”，貌似
蒋雯丽童鞋在某某电视剧里的装备。这回完全是看在春暖花开的面子上，我们想出去骑
游了，加上之前我们单位也在召唤组织骑游and上上上周几个公务员同志策划的出游因
下雨而泡汤。对不起，我的stack够深，跟不上的同志慢慢回溯啊。&lt;/p&gt;
&lt;p&gt;上上周我们很兴奋的骑行去了武都，一个跟龙门town很相似的地方------------灰大！
回来被告知有另外一条羊肠小道，遂决定上周末再此出行。怎料，judy被通知要去上该
死的什么什么会计资格考试培训，下周末才考试，也就是说，这阳春三月的周末我都得
一个人过了。&lt;/p&gt;
&lt;p&gt;周五正上班，彬哥来一电话，我还些许诧异，说是金忠伟来成都了，叫我也过去玩，哎
呀呀想想毕业都快三年了，还真的蛮想念大家的。记得去年才来绵阳没多久，小强从上
海回来，咱俩聚了聚，之前在成都跟彬哥、波C也小聚了一把。这回这小子跑来干嘛，
周六一早我慢悠悠的坐火车到了成都。&lt;/p&gt;
&lt;p&gt;在文殊院碰头了，好嘛，小子越来越潮了，哈哈......大家一路欢畅地聊着，彬哥带着
我们径直去了明婷，成都最牛的苍蝇馆子，脑花豆腐不错，但水煮鱼就差点了。金大伟
还是不喝酒，对了，他扛了个长枪大炮来成都拍美女，也不知道战果如何，忘了找他要
两张来晒晒了。&lt;/p&gt;
&lt;p&gt;席间聊起来，哥几个都混得不错，彬哥人家猎头挖，波C肩挑成都地铁二号线重任，金
大伟就更不用说了，把了个南航的空姐，说还是twins，这回是去人家重庆家里登门，
顺便来成都玩的，看样子好事不远了。想我们一帮子大学同学，学强电的，我却倒腾上
了代码，原来也就玩个单片机，跑的也算个单线程了吧，贻笑大方了，哈哈。&lt;/p&gt;
&lt;p&gt;下午这小子要回重庆，彬哥安排他感受了把成都血战的风采，波C可是久经沙场，可苦
了我这个“报伙子”。一个小时左右，两三百个大洋就流走了，呵呵，杀得我胆颤心惊啊
。&lt;/p&gt;
&lt;p&gt;欢乐的时光总是那么短暂，彬哥留我周日再走，确实不行，周日请了松林和海岩来家做
客，于是相约下次再聚。我目送他们离去，心里有说不出的感觉，高兴又难受，下回去
杭州得好好宰他一刀。&lt;/p&gt;</content><category term="daily"></category><category term="weekend"></category></entry><entry><title>Born this way</title><link href="http://blog.onionisi.com/born-this-way.html" rel="alternate"></link><published>2012-03-07T00:00:00+08:00</published><updated>2012-03-07T00:00:00+08:00</updated><author><name>Chong</name></author><id>tag:blog.onionisi.com,2012-03-07:/born-this-way.html</id><summary type="html">&lt;p&gt;说了好久弄个人博客的事情了，但总是这样那样，说白了也就是自己懒，好歹现在勉强能看了。&lt;/p&gt;
&lt;h2&gt;WP&lt;/h2&gt;
&lt;p&gt;其实早之前就想自己弄块地，记得去年还是神马时候，还专门找了视频认真观摩，后边也不了了之，前段手头没多少活就在公司的机子上自己弄了个WP，玩了两天，后边因为重装系统，也没活多长时间。&lt;/p&gt;
&lt;p&gt;这玩意儿确实要麻烦点，平台，数据库，要想好看还得还一大堆插件，关键你写东西还要登入后台，而且还要在那个输入的小框用各种格式来控制格式，用惯了纯文本的编辑器来倒腾这些真的很让人受不了啊亲。&lt;/p&gt;
&lt;h2&gt;jekyll&lt;/h2&gt;
&lt;p&gt;遇见这个神器还要谢谢&lt;a href="http://www.yangzhiping.com/"&gt;阳志平老师的博客&lt;/a&gt;的推荐，其实一开始我感兴趣的是&lt;a href="http://octopress.org/"&gt;Octopress&lt;/a&gt;，因为他看着跟WP差不多，但是随着深入理解我发现了幕后的英雄&lt;a href="https://github.com/mojombo/jekyll"&gt;jekyll&lt;/a&gt;。
本着从简从的原则，我开始摆弄这玩意儿。因为办公室的狗屁网络环境，之前在弄ruby的工具gem时候费了我不少周章。具体动手玩的指南请看&lt;a href="https://github.com/mojombo/jekyll/wiki"&gt;WiKi&lt;/a&gt; 。就像玩Arch的同志一样，不看wiki你注定要死得很惨或者毫无头绪。
伟大的开源造就了很多让你想不到的神物，这是我使用github之后唯一的感慨，无疑jekyll就是其中之一，当然还有现在我正在使用中的Oh-My-Zsh等等。虽然作为半个苦逼的写C的码农，对于前端的各式五花八门的技术不懂，但觉着这么简洁给力的博客系统不用实在是太对不起我码农的称号了，在加上git和md的加持，真的是方便到没话说。&lt;/p&gt;</summary><content type="html">&lt;p&gt;说了好久弄个人博客的事情了，但总是这样那样，说白了也就是自己懒，好歹现在勉强能看了。&lt;/p&gt;
&lt;h2&gt;WP&lt;/h2&gt;
&lt;p&gt;其实早之前就想自己弄块地，记得去年还是神马时候，还专门找了视频认真观摩，后边也不了了之，前段手头没多少活就在公司的机子上自己弄了个WP，玩了两天，后边因为重装系统，也没活多长时间。&lt;/p&gt;
&lt;p&gt;这玩意儿确实要麻烦点，平台，数据库，要想好看还得还一大堆插件，关键你写东西还要登入后台，而且还要在那个输入的小框用各种格式来控制格式，用惯了纯文本的编辑器来倒腾这些真的很让人受不了啊亲。&lt;/p&gt;
&lt;h2&gt;jekyll&lt;/h2&gt;
&lt;p&gt;遇见这个神器还要谢谢&lt;a href="http://www.yangzhiping.com/"&gt;阳志平老师的博客&lt;/a&gt;的推荐，其实一开始我感兴趣的是&lt;a href="http://octopress.org/"&gt;Octopress&lt;/a&gt;，因为他看着跟WP差不多，但是随着深入理解我发现了幕后的英雄&lt;a href="https://github.com/mojombo/jekyll"&gt;jekyll&lt;/a&gt;。
本着从简从的原则，我开始摆弄这玩意儿。因为办公室的狗屁网络环境，之前在弄ruby的工具gem时候费了我不少周章。具体动手玩的指南请看&lt;a href="https://github.com/mojombo/jekyll/wiki"&gt;WiKi&lt;/a&gt; 。就像玩Arch的同志一样，不看wiki你注定要死得很惨或者毫无头绪。
伟大的开源造就了很多让你想不到的神物，这是我使用github之后唯一的感慨，无疑jekyll就是其中之一，当然还有现在我正在使用中的Oh-My-Zsh等等。虽然作为半个苦逼的写C的码农，对于前端的各式五花八门的技术不懂，但觉着这么简洁给力的博客系统不用实在是太对不起我码农的称号了，在加上git和md的加持，真的是方便到没话说。&lt;/p&gt;</content><category term="daily"></category><category term="jekyll"></category><category term="web"></category></entry></feed>